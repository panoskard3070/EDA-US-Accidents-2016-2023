<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>292fd67372d64704b30a8f9e805423ac</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="gmoQ81GmiuEe">
<p>#<strong>EDA U.S. Accidents (2016-2023)</strong></p>
<p><strong>Author:</strong>
<code>Panagiotis Kardatos, Mathematician</code></p>
<p><strong>Date:</strong> <code>Late October 2025</code></p>
<p><strong>Data Source:</strong> <a
href="https://www.kaggle.com/datasets/sobhanmoosavi/us-accidents/data"
class="uri">https://www.kaggle.com/datasets/sobhanmoosavi/us-accidents/data</a></p>
<p>This project performs an EDA on the U.S. Accidents Dataset across
years 2016-2023. The dataset contains more than 7 millions records in
during that time interval. The main objective is to analyze large scale
data and extract meaningfull insights about time of accident, weather,
and accident distribution across U.S. We will also utilize GPU for this
project.</p>
</div>
<div class="cell markdown" id="_epkHCQusxq7">
<p>##<strong>Step 1: Data Import and Load</strong></p>
<p>At this initial step we will:</p>
<ul>
<li>Install and Import all the required libraries</li>
<li>Download the data and view the download path</li>
<li>Set Up the initial Dataframes</li>
</ul>
</div>
<div class="cell code" data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="XaQ7WSlsiedJ" data-outputId="5907d111-ffd8-4b0b-ddc8-4782b763860d">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GPU info for CUDA (Set GPU as an accelerator to your notebook)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>nvidia<span class="op">-</span>smi</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Wed Oct 29 08:55:34 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.54.15              Driver Version: 550.54.15      CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla T4                       Off |   00000000:00:04.0 Off |                    0 |
| N/A   49C    P8              9W /   70W |       0MiB /  15360MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="WvfxcDMDt8Rb" data-outputId="570ab39c-170c-44c6-c1fc-95130902b3e7">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Libraries Installation (For GPU and Kaggle)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install cudf<span class="op">-</span>cu12 <span class="op">--</span>index<span class="op">-</span>url<span class="op">=</span>https:<span class="op">//</span>pypi.nvidia.com</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install kagglehub</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Looking in indexes: https://pypi.nvidia.com
Requirement already satisfied: cudf-cu12 in /usr/local/lib/python3.12/dist-packages (25.6.0)
Requirement already satisfied: cachetools in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (5.5.2)
Requirement already satisfied: cuda-python&lt;13.0a0,&gt;=12.6.2 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (12.6.2.post1)
Requirement already satisfied: cupy-cuda12x&gt;=12.0.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (13.3.0)
Requirement already satisfied: fsspec&gt;=0.6.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (2025.3.0)
Requirement already satisfied: libcudf-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (25.6.0)
Requirement already satisfied: numba-cuda&lt;0.12.0a0,&gt;=0.11.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (0.11.0)
Requirement already satisfied: numba&lt;0.62.0a0,&gt;=0.59.1 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (0.60.0)
Requirement already satisfied: numpy&lt;3.0a0,&gt;=1.23 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (2.0.2)
Requirement already satisfied: nvidia-cuda-nvcc-cu12 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (12.5.82)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (12.6.77)
Requirement already satisfied: nvtx&gt;=0.2.1 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (0.2.13)
Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (25.0)
Requirement already satisfied: pandas&lt;2.2.4dev0,&gt;=2.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (2.2.2)
Requirement already satisfied: pyarrow&lt;20.0.0a0,&gt;=14.0.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (18.1.0)
Requirement already satisfied: pylibcudf-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (25.6.0)
Requirement already satisfied: pynvjitlink-cu12 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (0.7.0)
Requirement already satisfied: rich in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (13.9.4)
Requirement already satisfied: rmm-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (25.6.0)
Requirement already satisfied: typing_extensions&gt;=4.0.0 in /usr/local/lib/python3.12/dist-packages (from cudf-cu12) (4.15.0)
Requirement already satisfied: libkvikio-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from libcudf-cu12==25.6.*-&gt;cudf-cu12) (25.6.0)
Requirement already satisfied: librmm-cu12==25.6.* in /usr/local/lib/python3.12/dist-packages (from libcudf-cu12==25.6.*-&gt;cudf-cu12) (25.6.0)
Requirement already satisfied: rapids-logger==0.1.* in /usr/local/lib/python3.12/dist-packages (from libcudf-cu12==25.6.*-&gt;cudf-cu12) (0.1.19)
Requirement already satisfied: fastrlock&gt;=0.5 in /usr/local/lib/python3.12/dist-packages (from cupy-cuda12x&gt;=12.0.0-&gt;cudf-cu12) (0.8.3)
Requirement already satisfied: llvmlite&lt;0.44,&gt;=0.43.0dev0 in /usr/local/lib/python3.12/dist-packages (from numba&lt;0.62.0a0,&gt;=0.59.1-&gt;cudf-cu12) (0.43.0)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.12/dist-packages (from pandas&lt;2.2.4dev0,&gt;=2.0-&gt;cudf-cu12) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.12/dist-packages (from pandas&lt;2.2.4dev0,&gt;=2.0-&gt;cudf-cu12) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.12/dist-packages (from pandas&lt;2.2.4dev0,&gt;=2.0-&gt;cudf-cu12) (2025.2)
Requirement already satisfied: markdown-it-py&gt;=2.2.0 in /usr/local/lib/python3.12/dist-packages (from rich-&gt;cudf-cu12) (4.0.0)
Requirement already satisfied: pygments&lt;3.0.0,&gt;=2.13.0 in /usr/local/lib/python3.12/dist-packages (from rich-&gt;cudf-cu12) (2.19.2)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.12/dist-packages (from markdown-it-py&gt;=2.2.0-&gt;rich-&gt;cudf-cu12) (0.1.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.12/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&lt;2.2.4dev0,&gt;=2.0-&gt;cudf-cu12) (1.17.0)
Requirement already satisfied: kagglehub in /usr/local/lib/python3.12/dist-packages (0.3.13)
Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from kagglehub) (25.0)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.12/dist-packages (from kagglehub) (6.0.3)
Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (from kagglehub) (2.32.4)
Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (from kagglehub) (4.67.1)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (3.4.4)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (3.11)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;kagglehub) (2025.10.5)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="3" id="b_8Zh0EPutET">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importing the libraries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cudf</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> kagglehub</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> userdata  <span class="co">#For Personal info</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="4" id="UWXojUzc5ZpH">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Kagglehub Personal Info</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;KAGGLE_USERNAME&#39;</span>] <span class="op">=</span> userdata.get(<span class="st">&#39;user&#39;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">&#39;KAGGLE_KEY&#39;</span>] <span class="op">=</span> userdata.get(<span class="st">&#39;key&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="5"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="BO2ZR7p6v6j5" data-outputId="d6304874-f974-4794-9045-64e64348e9ac">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dataset Download</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> kagglehub.dataset_download(<span class="st">&quot;sobhanmoosavi/us-accidents&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(path)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Using Colab cache for faster access to the &#39;us-accidents&#39; dataset.
/kaggle/input/us-accidents
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="6"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="8BAsfL9OwTMj" data-outputId="30c92507-9acd-4110-fe4c-ea3de20ebbb1">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Full File Path</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>file_path <span class="op">=</span> os.path.join(path, <span class="st">&#39;US_Accidents_March23.csv&#39;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(file_path)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>/kaggle/input/us-accidents/US_Accidents_March23.csv
</code></pre>
</div>
</div>
<div class="cell markdown" id="QiMdzq1txS8c">
<p>For Pandas we will use the chunksize approach. Let's see first the
exact number of rows.</p>
</div>
<div class="cell code" data-execution_count="7"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="DaqWFUXwxgQE" data-outputId="8eb712e3-011e-4d87-962c-cc50fe0d283c">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Preview Number of rows before loading</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(file_path, <span class="st">&#39;r&#39;</span>) <span class="im">as</span> f:</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  row_count <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> _ <span class="kw">in</span> f)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(row_count)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>7728395
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="N8Zq0yHXynNr" data-outputId="e730aa5d-0044-4d8b-cba5-6c3151e744a4">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pandas DataFrame</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>start<span class="op">=</span>time.time()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>chunker <span class="op">=</span> pd.read_csv(file_path, chunksize<span class="op">=</span><span class="dv">500000</span>) <span class="co">#Chunksize of 500k rows</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="bu">next</span>(chunker) <span class="co"># First Chunk out of 16</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>end<span class="op">=</span>time.time()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>end<span class="op">-</span>start<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#cuDF Dataframe</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>start<span class="op">=</span>time.time()</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>cf <span class="op">=</span> cudf.read_csv(file_path)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>end<span class="op">=</span>time.time()</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>end<span class="op">-</span>start<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>3.53
2.43
</code></pre>
</div>
</div>
<div class="cell markdown" id="2soZwj3G6x3h">
<p>As a first comment if we load to pandas the whole dataset, the system
crashes so we chose the chunksize approach.</p>
<ul>
<li><p>In Pandas we loaded 500k rows out of 7.72 million and it took 7.6
sec.</p></li>
<li><p>In Cudf, we loaded all 7.72 million rows and it took around 2.06
sec.</p></li>
</ul>
<p>This is a first taste in GPU computational superiority over CPU in
large scale datasets.</p>
</div>
<div class="cell markdown" id="ayhdehB6D06P">
<p>##<strong>Step 2: Data Inspection</strong> At this step we will:</p>
<ul>
<li>Get a first view of the data</li>
<li>Understand the column types, view the shape</li>
<li>Compute any missing values per column</li>
</ul>
</div>
<div class="cell markdown" id="Tqqgmr1XGyyF">
<p>###<strong>Pandas</strong></p>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="4_6HVK5kElJ0" data-outputId="3a626f66-1197-4dcf-b661-e995a348b130">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First Chunk</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

  <div id="df-2221fcbe-c944-47b6-96c6-83223e126ada" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>End_Time</th>
      <th>Start_Lat</th>
      <th>Start_Lng</th>
      <th>End_Lat</th>
      <th>End_Lng</th>
      <th>Distance(mi)</th>
      <th>...</th>
      <th>Roundabout</th>
      <th>Station</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
      <th>Traffic_Signal</th>
      <th>Turning_Loop</th>
      <th>Sunrise_Sunset</th>
      <th>Civil_Twilight</th>
      <th>Nautical_Twilight</th>
      <th>Astronomical_Twilight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A-1</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 05:46:00</td>
      <td>2016-02-08 11:00:00</td>
      <td>39.865147</td>
      <td>-84.058723</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Night</td>
      <td>Night</td>
      <td>Night</td>
      <td>Night</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A-2</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:07:59</td>
      <td>2016-02-08 06:37:59</td>
      <td>39.928059</td>
      <td>-82.831184</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Night</td>
      <td>Night</td>
      <td>Night</td>
      <td>Day</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A-3</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:49:27</td>
      <td>2016-02-08 07:19:27</td>
      <td>39.063148</td>
      <td>-84.032608</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>Night</td>
      <td>Night</td>
      <td>Day</td>
      <td>Day</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A-4</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 07:23:34</td>
      <td>2016-02-08 07:53:34</td>
      <td>39.747753</td>
      <td>-84.205582</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Night</td>
      <td>Day</td>
      <td>Day</td>
      <td>Day</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A-5</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 07:39:07</td>
      <td>2016-02-08 08:09:07</td>
      <td>39.627781</td>
      <td>-84.188354</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>Day</td>
      <td>Day</td>
      <td>Day</td>
      <td>Day</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 46 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2221fcbe-c944-47b6-96c6-83223e126ada')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2221fcbe-c944-47b6-96c6-83223e126ada button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2221fcbe-c944-47b6-96c6-83223e126ada');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-40f7b90e-f599-4137-b028-f32077e8ff7d">
      <button class="colab-df-quickchart" onclick="quickchart('df-40f7b90e-f599-4137-b028-f32077e8ff7d')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-40f7b90e-f599-4137-b028-f32077e8ff7d button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="1vDa-mGZEx80" data-outputId="9b1e725f-2f1c-46ee-bebe-8c53938429f4">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#General Information (first chunk)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>df<span class="sc">.</span>info()<span class="sc">}</span><span class="ch">\n</span><span class="ss">SHAPE:</span><span class="sc">{</span>df<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 500000 entries, 0 to 499999
Data columns (total 46 columns):
 #   Column                 Non-Null Count   Dtype  
---  ------                 --------------   -----  
 0   ID                     500000 non-null  object 
 1   Source                 500000 non-null  object 
 2   Severity               500000 non-null  int64  
 3   Start_Time             500000 non-null  object 
 4   End_Time               500000 non-null  object 
 5   Start_Lat              500000 non-null  float64
 6   Start_Lng              500000 non-null  float64
 7   End_Lat                0 non-null       float64
 8   End_Lng                0 non-null       float64
 9   Distance(mi)           500000 non-null  float64
 10  Description            500000 non-null  object 
 11  Street                 500000 non-null  object 
 12  City                   499978 non-null  object 
 13  County                 500000 non-null  object 
 14  State                  500000 non-null  object 
 15  Zipcode                499942 non-null  object 
 16  Country                500000 non-null  object 
 17  Timezone               499942 non-null  object 
 18  Airport_Code           499940 non-null  object 
 19  Weather_Timestamp      495885 non-null  object 
 20  Temperature(F)         492750 non-null  float64
 21  Wind_Chill(F)          62359 non-null   float64
 22  Humidity(%)            492085 non-null  float64
 23  Pressure(in)           494261 non-null  float64
 24  Visibility(mi)         489461 non-null  float64
 25  Wind_Direction         495853 non-null  object 
 26  Wind_Speed(mph)        410960 non-null  float64
 27  Precipitation(in)      51946 non-null   float64
 28  Weather_Condition      489815 non-null  object 
 29  Amenity                500000 non-null  bool   
 30  Bump                   500000 non-null  bool   
 31  Crossing               500000 non-null  bool   
 32  Give_Way               500000 non-null  bool   
 33  Junction               500000 non-null  bool   
 34  No_Exit                500000 non-null  bool   
 35  Railway                500000 non-null  bool   
 36  Roundabout             500000 non-null  bool   
 37  Station                500000 non-null  bool   
 38  Stop                   500000 non-null  bool   
 39  Traffic_Calming        500000 non-null  bool   
 40  Traffic_Signal         500000 non-null  bool   
 41  Turning_Loop           500000 non-null  bool   
 42  Sunrise_Sunset         499978 non-null  object 
 43  Civil_Twilight         499978 non-null  object 
 44  Nautical_Twilight      499978 non-null  object 
 45  Astronomical_Twilight  499978 non-null  object 
dtypes: bool(13), float64(12), int64(1), object(20)
memory usage: 132.1+ MB
None
SHAPE:(500000, 46)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="11"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="QgFEjbNJFP09" data-outputId="a3917d4d-48ad-4b08-b90c-b2bb565af199">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Null Values For First Chunk</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ID</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Source</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Severity</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Start_Time</th>
      <td>0</td>
    </tr>
    <tr>
      <th>End_Time</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Start_Lat</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Start_Lng</th>
      <td>0</td>
    </tr>
    <tr>
      <th>End_Lat</th>
      <td>500000</td>
    </tr>
    <tr>
      <th>End_Lng</th>
      <td>500000</td>
    </tr>
    <tr>
      <th>Distance(mi)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Description</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Street</th>
      <td>0</td>
    </tr>
    <tr>
      <th>City</th>
      <td>22</td>
    </tr>
    <tr>
      <th>County</th>
      <td>0</td>
    </tr>
    <tr>
      <th>State</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Zipcode</th>
      <td>58</td>
    </tr>
    <tr>
      <th>Country</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Timezone</th>
      <td>58</td>
    </tr>
    <tr>
      <th>Airport_Code</th>
      <td>60</td>
    </tr>
    <tr>
      <th>Weather_Timestamp</th>
      <td>4115</td>
    </tr>
    <tr>
      <th>Temperature(F)</th>
      <td>7250</td>
    </tr>
    <tr>
      <th>Wind_Chill(F)</th>
      <td>437641</td>
    </tr>
    <tr>
      <th>Humidity(%)</th>
      <td>7915</td>
    </tr>
    <tr>
      <th>Pressure(in)</th>
      <td>5739</td>
    </tr>
    <tr>
      <th>Visibility(mi)</th>
      <td>10539</td>
    </tr>
    <tr>
      <th>Wind_Direction</th>
      <td>4147</td>
    </tr>
    <tr>
      <th>Wind_Speed(mph)</th>
      <td>89040</td>
    </tr>
    <tr>
      <th>Precipitation(in)</th>
      <td>448054</td>
    </tr>
    <tr>
      <th>Weather_Condition</th>
      <td>10185</td>
    </tr>
    <tr>
      <th>Amenity</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Bump</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Crossing</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Give_Way</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Junction</th>
      <td>0</td>
    </tr>
    <tr>
      <th>No_Exit</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Railway</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Roundabout</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Station</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Stop</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Traffic_Calming</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Traffic_Signal</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Turning_Loop</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Sunrise_Sunset</th>
      <td>22</td>
    </tr>
    <tr>
      <th>Civil_Twilight</th>
      <td>22</td>
    </tr>
    <tr>
      <th>Nautical_Twilight</th>
      <td>22</td>
    </tr>
    <tr>
      <th>Astronomical_Twilight</th>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell markdown" id="6Uvv12hOH9ic">
<p>###<strong>CUDF</strong></p>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:429}"
id="LNZGsdjoGP1E" data-outputId="8c1b5f47-57e7-45f1-dabc-648c0b631bb7">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First View</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cf.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>End_Time</th>
      <th>Start_Lat</th>
      <th>Start_Lng</th>
      <th>End_Lat</th>
      <th>End_Lng</th>
      <th>Distance(mi)</th>
      <th>...</th>
      <th>Roundabout</th>
      <th>Station</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
      <th>Traffic_Signal</th>
      <th>Turning_Loop</th>
      <th>Sunrise_Sunset</th>
      <th>Civil_Twilight</th>
      <th>Nautical_Twilight</th>
      <th>Astronomical_Twilight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A-1</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 05:46:00</td>
      <td>2016-02-08 11:00:00</td>
      <td>39.865147</td>
      <td>-84.058723</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Night</td>
      <td>Night</td>
      <td>Night</td>
      <td>Night</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A-2</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:07:59</td>
      <td>2016-02-08 06:37:59</td>
      <td>39.928059</td>
      <td>-82.831184</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Night</td>
      <td>Night</td>
      <td>Night</td>
      <td>Day</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A-3</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:49:27</td>
      <td>2016-02-08 07:19:27</td>
      <td>39.063148</td>
      <td>-84.032608</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>Night</td>
      <td>Night</td>
      <td>Day</td>
      <td>Day</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A-4</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 07:23:34</td>
      <td>2016-02-08 07:53:34</td>
      <td>39.747753</td>
      <td>-84.205582</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Night</td>
      <td>Day</td>
      <td>Day</td>
      <td>Day</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A-5</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 07:39:07</td>
      <td>2016-02-08 08:09:07</td>
      <td>39.627781</td>
      <td>-84.188354</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>0.01</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>Day</td>
      <td>Day</td>
      <td>Day</td>
      <td>Day</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 46 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="gNFkDBRfIJh8" data-outputId="c5a4b21d-b247-431e-8e8a-4aa33ee99183">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Data Type and Shape</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>cf<span class="sc">.</span>info()<span class="sc">}</span><span class="ch">\n</span><span class="ss">SHAPE:</span><span class="sc">{</span>cf<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;cudf.core.dataframe.DataFrame&#39;&gt;
RangeIndex: 7728394 entries, 0 to 7728393
Data columns (total 46 columns):
 #   Column                 Dtype
---  ------                 -----
 0   ID                     object
 1   Source                 object
 2   Severity               int64
 3   Start_Time             object
 4   End_Time               object
 5   Start_Lat              float64
 6   Start_Lng              float64
 7   End_Lat                float64
 8   End_Lng                float64
 9   Distance(mi)           float64
 10  Description            object
 11  Street                 object
 12  City                   object
 13  County                 object
 14  State                  object
 15  Zipcode                object
 16  Country                object
 17  Timezone               object
 18  Airport_Code           object
 19  Weather_Timestamp      object
 20  Temperature(F)         float64
 21  Wind_Chill(F)          float64
 22  Humidity(%)            float64
 23  Pressure(in)           float64
 24  Visibility(mi)         float64
 25  Wind_Direction         object
 26  Wind_Speed(mph)        float64
 27  Precipitation(in)      float64
 28  Weather_Condition      object
 29  Amenity                bool
 30  Bump                   bool
 31  Crossing               bool
 32  Give_Way               bool
 33  Junction               bool
 34  No_Exit                bool
 35  Railway                bool
 36  Roundabout             bool
 37  Station                bool
 38  Stop                   bool
 39  Traffic_Calming        bool
 40  Traffic_Signal         bool
 41  Turning_Loop           bool
 42  Sunrise_Sunset         object
 43  Civil_Twilight         object
 44  Nautical_Twilight      object
 45  Astronomical_Twilight  object
dtypes: bool(13), float64(12), int64(1), object(20)
memory usage: 3.0+ GB
None
SHAPE:(7728394, 46)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="q8aU-zxeITG3" data-outputId="08fdef6b-396a-4e6a-80fb-259e74e7b400">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Null Values</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cf.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">
<pre><code>ID                             0
Source                         0
Severity                       0
Start_Time                     0
End_Time                       0
Start_Lat                      0
Start_Lng                      0
End_Lat                  3402762
End_Lng                  3402762
Distance(mi)                   0
Description                    5
Street                     10869
City                         253
County                         0
State                          0
Zipcode                     1915
Country                        0
Timezone                    7808
Airport_Code               22635
Weather_Timestamp         120228
Temperature(F)            163853
Wind_Chill(F)            1999019
Humidity(%)               174144
Pressure(in)              140679
Visibility(mi)            177098
Wind_Direction            175206
Wind_Speed(mph)           571233
Precipitation(in)        2203586
Weather_Condition         173459
Amenity                        0
Bump                           0
Crossing                       0
Give_Way                       0
Junction                       0
No_Exit                        0
Railway                        0
Roundabout                     0
Station                        0
Stop                           0
Traffic_Calming                0
Traffic_Signal                 0
Turning_Loop                   0
Sunrise_Sunset             23246
Civil_Twilight             23246
Nautical_Twilight          23246
Astronomical_Twilight      23246
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="D8r-cU_7MQlP">
<p>##<strong>Step 3: Data Cleaning</strong> At this step we will clean
data both in pandas and cudf. We will</p>
<ul>
<li>Drop columns that are not related for the analysis and their null
values can affect the size of the dataset</li>
<li>Drop rows with missing values</li>
<li>Drop duplicate rows</li>
<li>Define a Data Cleaning function for chunks</li>
</ul>
<p>Missing values in numeric data will be filled with mean or median.
They can also be predicted with machine learning techniques
(multivariable linear regression) however this is outside of the scope
of this project.</p>
<p>The deal here is to preserve as much data as possible. As it was
stated above a Data Cleaning Function will be defined. This is because
we will perform a loop later for all the chunks in chunker to be
cleaned. More to follow.</p>
</div>
<div class="cell markdown" id="125l5SP8PnB7">
<p>###<strong>Pandas</strong></p>
</div>
<div class="cell markdown" id="lNk796zU2oeI">
<p>####<strong>Dropping Columns</strong></p>
</div>
<div class="cell code" data-execution_count="15"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="J9mr9RRHPwc_" data-outputId="609e9c8f-e693-42dd-f59e-b8274f32074a">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="15">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ID</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Source</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Severity</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Start_Time</th>
      <td>0</td>
    </tr>
    <tr>
      <th>End_Time</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Start_Lat</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Start_Lng</th>
      <td>0</td>
    </tr>
    <tr>
      <th>End_Lat</th>
      <td>500000</td>
    </tr>
    <tr>
      <th>End_Lng</th>
      <td>500000</td>
    </tr>
    <tr>
      <th>Distance(mi)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Description</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Street</th>
      <td>0</td>
    </tr>
    <tr>
      <th>City</th>
      <td>22</td>
    </tr>
    <tr>
      <th>County</th>
      <td>0</td>
    </tr>
    <tr>
      <th>State</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Zipcode</th>
      <td>58</td>
    </tr>
    <tr>
      <th>Country</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Timezone</th>
      <td>58</td>
    </tr>
    <tr>
      <th>Airport_Code</th>
      <td>60</td>
    </tr>
    <tr>
      <th>Weather_Timestamp</th>
      <td>4115</td>
    </tr>
    <tr>
      <th>Temperature(F)</th>
      <td>7250</td>
    </tr>
    <tr>
      <th>Wind_Chill(F)</th>
      <td>437641</td>
    </tr>
    <tr>
      <th>Humidity(%)</th>
      <td>7915</td>
    </tr>
    <tr>
      <th>Pressure(in)</th>
      <td>5739</td>
    </tr>
    <tr>
      <th>Visibility(mi)</th>
      <td>10539</td>
    </tr>
    <tr>
      <th>Wind_Direction</th>
      <td>4147</td>
    </tr>
    <tr>
      <th>Wind_Speed(mph)</th>
      <td>89040</td>
    </tr>
    <tr>
      <th>Precipitation(in)</th>
      <td>448054</td>
    </tr>
    <tr>
      <th>Weather_Condition</th>
      <td>10185</td>
    </tr>
    <tr>
      <th>Amenity</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Bump</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Crossing</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Give_Way</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Junction</th>
      <td>0</td>
    </tr>
    <tr>
      <th>No_Exit</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Railway</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Roundabout</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Station</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Stop</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Traffic_Calming</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Traffic_Signal</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Turning_Loop</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Sunrise_Sunset</th>
      <td>22</td>
    </tr>
    <tr>
      <th>Civil_Twilight</th>
      <td>22</td>
    </tr>
    <tr>
      <th>Nautical_Twilight</th>
      <td>22</td>
    </tr>
    <tr>
      <th>Astronomical_Twilight</th>
      <td>22</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell markdown" id="nys85URX42Op">
<p>We begin by dropping columns</p>
</div>
<div class="cell code" data-execution_count="16" id="-TXiSQ2442wJ">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Drop Columns</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">&#39;Start_Lat&#39;</span>,<span class="st">&#39;Start_Lng&#39;</span>,<span class="st">&#39;End_Lat&#39;</span>,<span class="st">&#39;End_Lng&#39;</span>,<span class="st">&#39;Description&#39;</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Street&#39;</span>,<span class="st">&#39;Timezone&#39;</span>,<span class="st">&#39;Airport_Code&#39;</span>,<span class="st">&#39;Weather_Timestamp&#39;</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Wind_Chill(F)&#39;</span>,<span class="st">&#39;Humidity(%)&#39;</span>,<span class="st">&#39;Pressure(in)&#39;</span>,<span class="st">&#39;Wind_Direction&#39;</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Precipitation(in)&#39;</span>,<span class="st">&#39;Amenity&#39;</span>,<span class="st">&#39;Bump&#39;</span>,<span class="st">&#39;Junction&#39;</span>,<span class="st">&#39;No_Exit&#39;</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Station&#39;</span>,<span class="st">&#39;Traffic_Signal&#39;</span>,<span class="st">&#39;Turning_Loop&#39;</span>,<span class="st">&#39;Sunrise_Sunset&#39;</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Civil_Twilight&#39;</span>,<span class="st">&#39;Nautical_Twilight&#39;</span>,<span class="st">&#39;Astronomical_Twilight&#39;</span>],</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="eSEtYxb02tw6">
<p>####<strong>Filling Missing Values</strong></p>
</div>
<div class="cell markdown" id="52I9knlZIYn8">
<p>Now we will investigate what's better to fill the columns,
<code>Temperature(F)</code>,<code>Visibility(mi)</code> and
<code>Wind_Speed(mph)</code>, median or mean. The idea is to get a first
view of sample's mean and median for each column, the extend it by
state. Then we will compute the the percentage: <span
class="math inline">$\dfrac{mean-median}{median}\cdot 100\%$</span>.</p>
<p>If the result percentage is between 2-5%, it's an indication that we
have a small ammount of skewnewss. There are going going to be some
outliers and it's up to us to decide. If it's over over 5% then we
definitely need to use median. My approach is when &gt;2% to use
median.</p>
</div>
<div class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="bTC53dGd8HVs" data-outputId="55f0f42f-5887-40b0-834e-b89c25b98135">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Sample&#39;s Mean and Median for Temp, Visibility, Wind Speed</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Mean, Median&#39;</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>df[<span class="st">&#39;Temperature(F)&#39;</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">, </span><span class="sc">{</span>df[<span class="st">&#39;Temperature(F)&#39;</span>]<span class="sc">.</span>median()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>df[<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">,  </span><span class="sc">{</span>df[<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="sc">.</span>median()<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>df[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">,  </span><span class="sc">{</span>df[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="sc">.</span>median()<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mean, Median
64.7, 66.2
9.2,  10.0
8.9,  8.1
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:289}"
id="xEJ2FlBUC0Xp" data-outputId="c6dc0e4d-7742-4889-adac-58c450c8fa49">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Making an instant GroupBy Analysis by State</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>test<span class="op">=</span>(df.groupby(<span class="st">&#39;State&#39;</span>)[[<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a> .agg([<span class="st">&#39;mean&#39;</span>,<span class="st">&#39;median&#39;</span>]))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Percentage Diffrence of mean and median</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]:</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  test[i<span class="op">+</span><span class="st">&#39;_pct&#39;</span>]<span class="op">=</span><span class="bu">abs</span>((test[(i,<span class="st">&#39;mean&#39;</span>)]<span class="op">-</span>test[(i,<span class="st">&#39;median&#39;</span>)]))<span class="op">/</span>test[(i,<span class="st">&#39;median&#39;</span>)]</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a mask &gt;0.02%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]:</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  test[i<span class="op">+</span><span class="st">&#39;_mask&#39;</span>]<span class="op">=</span>test[i<span class="op">+</span><span class="st">&#39;_pct&#39;</span>]<span class="op">&gt;</span><span class="fl">0.02</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Dictionaries for mean,median and masks, to get easier access.</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>temp_mean_dic <span class="op">=</span> test[(<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>temp_median_dic <span class="op">=</span> test[(<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>temp_mask_dic <span class="op">=</span> test[<span class="st">&#39;Temperature(F)_mask&#39;</span>].to_dict()</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>vis_mean_dic <span class="op">=</span> test[(<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>vis_median_dic <span class="op">=</span> test[(<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>vis_mask_dic <span class="op">=</span> test[<span class="st">&#39;Visibility(mi)_mask&#39;</span>].to_dict()</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>win_mean_dic <span class="op">=</span> test[(<span class="st">&#39;Wind_Speed(mph)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>win_median_dic <span class="op">=</span> test[(<span class="st">&#39;Wind_Speed(mph)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>win_mask_dic <span class="op">=</span> test[<span class="st">&#39;Wind_Speed(mph)_mask&#39;</span>].to_dict()</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co">#A quick preview so far</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>test.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">

  <div id="df-632c9439-430d-49f4-aa12-5ded2ef5ccd0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Temperature(F)</th>
      <th colspan="2" halign="left">Visibility(mi)</th>
      <th colspan="2" halign="left">Wind_Speed(mph)</th>
      <th>Temperature(F)_pct</th>
      <th>Visibility(mi)_pct</th>
      <th>Wind_Speed(mph)_pct</th>
      <th>Temperature(F)_mask</th>
      <th>Visibility(mi)_mask</th>
      <th>Wind_Speed(mph)_mask</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
      <th>mean</th>
      <th>median</th>
      <th>mean</th>
      <th>median</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>State</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AL</th>
      <td>80.975000</td>
      <td>82.65</td>
      <td>10.000000</td>
      <td>10.0</td>
      <td>3.500000</td>
      <td>3.5</td>
      <td>0.020266</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>CA</th>
      <td>66.517473</td>
      <td>64.90</td>
      <td>9.322564</td>
      <td>10.0</td>
      <td>8.195351</td>
      <td>6.9</td>
      <td>0.024923</td>
      <td>0.067744</td>
      <td>0.187732</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>CT</th>
      <td>54.979555</td>
      <td>54.00</td>
      <td>8.903463</td>
      <td>10.0</td>
      <td>8.923575</td>
      <td>8.1</td>
      <td>0.018140</td>
      <td>0.109654</td>
      <td>0.101676</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>DC</th>
      <td>57.191811</td>
      <td>55.00</td>
      <td>9.292060</td>
      <td>10.0</td>
      <td>9.161186</td>
      <td>8.1</td>
      <td>0.039851</td>
      <td>0.070794</td>
      <td>0.131011</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>DE</th>
      <td>64.412174</td>
      <td>66.90</td>
      <td>9.691228</td>
      <td>10.0</td>
      <td>8.949533</td>
      <td>8.1</td>
      <td>0.037187</td>
      <td>0.030877</td>
      <td>0.104881</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-632c9439-430d-49f4-aa12-5ded2ef5ccd0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-632c9439-430d-49f4-aa12-5ded2ef5ccd0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-632c9439-430d-49f4-aa12-5ded2ef5ccd0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-1647973e-20a2-425b-b9eb-9925dd77e042">
      <button class="colab-df-quickchart" onclick="quickchart('df-1647973e-20a2-425b-b9eb-9925dd77e042')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-1647973e-20a2-425b-b9eb-9925dd77e042 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="19" id="thxWzeEAIdoO">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining Filling Functions</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#We will apply the function by rows (axis=1)</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#For Temperature</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_temp(row):</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Temperature(F)&#39;</span>]):</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> temp_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> temp_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> temp_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> row[<span class="st">&#39;Temperature(F)&#39;</span>]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">#For Visibility</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_vis(row):</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Visibility(mi)&#39;</span>]):</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> vis_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> vis_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> vis_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> row[<span class="st">&#39;Visibility(mi)&#39;</span>]</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a><span class="co">#For Wind Speed</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_wind(row):</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]):</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> win_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> win_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> win_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>:</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> row[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="20" id="1ujNBwys79_W">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mega Filling Function</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fill_rows(df):</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#For Temperature</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> fill_temp(row):</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Temperature(F)&#39;</span>]):</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> temp_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> temp_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> temp_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> row[<span class="st">&#39;Temperature(F)&#39;</span>]</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Temperature(F)&#39;</span>]<span class="op">=</span>df.<span class="bu">apply</span>(fill_temp,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#For Visibility</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> fill_vis(row):</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Visibility(mi)&#39;</span>]):</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> vis_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> vis_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> vis_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> row[<span class="st">&#39;Visibility(mi)&#39;</span>]</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="op">=</span>df.<span class="bu">apply</span>(fill_vis,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#For Wind Speed</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> fill_wind(row):</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]):</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> win_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> win_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> win_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> row[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="op">=</span>df.<span class="bu">apply</span>(fill_wind,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:760}"
id="XeZHxjet7-Bs" data-outputId="729a328d-6c42-4712-f8ff-41736cd37004">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Applying the function to Fill values in  all 3 columns</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>start<span class="op">=</span>time.time()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>fill_rows(df)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>end<span class="op">=</span>time.time()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>end<span class="op">-</span>start<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Verification</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>10.87
</code></pre>
</div>
<div class="output execute_result" data-execution_count="21">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ID</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Source</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Severity</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Start_Time</th>
      <td>0</td>
    </tr>
    <tr>
      <th>End_Time</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Distance(mi)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>City</th>
      <td>22</td>
    </tr>
    <tr>
      <th>County</th>
      <td>0</td>
    </tr>
    <tr>
      <th>State</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Zipcode</th>
      <td>58</td>
    </tr>
    <tr>
      <th>Country</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Temperature(F)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Visibility(mi)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Wind_Speed(mph)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Weather_Condition</th>
      <td>10185</td>
    </tr>
    <tr>
      <th>Crossing</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Give_Way</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Railway</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Roundabout</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Stop</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Traffic_Calming</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell markdown" id="dbbr7ETVNzes">
<p>####<strong>Dropping Remaining Null Values</strong></p>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:743}"
id="F27c1lVDN9ST" data-outputId="3fb82f67-f195-4909-cb63-0d26415513b1">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Drop Remaining NA&#39;s</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="22">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ID</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Source</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Severity</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Start_Time</th>
      <td>0</td>
    </tr>
    <tr>
      <th>End_Time</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Distance(mi)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>City</th>
      <td>0</td>
    </tr>
    <tr>
      <th>County</th>
      <td>0</td>
    </tr>
    <tr>
      <th>State</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Zipcode</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Country</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Temperature(F)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Visibility(mi)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Wind_Speed(mph)</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Weather_Condition</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Crossing</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Give_Way</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Railway</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Roundabout</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Stop</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Traffic_Calming</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label>
</div>
</div>
<div class="cell markdown" id="dJEiJ3ySO037">
<p>####<strong>Duplicates Check</strong></p>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Sr0uuEcpO_rh" data-outputId="34efec37-8e1e-4b69-bcff-54fcd19b4b76">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Duplicates Total Rows</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df.duplicated().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">
<pre><code>np.int64(0)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="24" id="zynyLioTPGag">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Resetting Index</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="3_J5GOOJM8-u">
<p>####<strong>Datetime Conversion</strong></p>
</div>
<div class="cell markdown" id="EjLY_XC-aewl">
<p>If we apply <code>pd.to_datetime</code> it's possible to encounter
errors in some chunks. This might be due to mixxed formats (date only or
date + time combination). The approach here will be different. We will
keep all Dates but we will exclude time so time analysis will be
performed in GPU. This means that the end time column here is
useless.</p>
</div>
<div class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:429}"
id="jPcdAepHcWxk" data-outputId="a5e04986-40ee-4a48-dba8-1bafd5ca8ebb">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">

  <div id="df-b040385a-7df1-4627-981c-1e83acd46f13" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>End_Time</th>
      <th>Distance(mi)</th>
      <th>City</th>
      <th>County</th>
      <th>State</th>
      <th>Zipcode</th>
      <th>...</th>
      <th>Temperature(F)</th>
      <th>Visibility(mi)</th>
      <th>Wind_Speed(mph)</th>
      <th>Weather_Condition</th>
      <th>Crossing</th>
      <th>Give_Way</th>
      <th>Railway</th>
      <th>Roundabout</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A-1</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 05:46:00</td>
      <td>2016-02-08 11:00:00</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45424</td>
      <td>...</td>
      <td>36.9</td>
      <td>10.0</td>
      <td>9.2</td>
      <td>Light Rain</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A-2</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:07:59</td>
      <td>2016-02-08 06:37:59</td>
      <td>0.01</td>
      <td>Reynoldsburg</td>
      <td>Franklin</td>
      <td>OH</td>
      <td>43068-3402</td>
      <td>...</td>
      <td>37.9</td>
      <td>10.0</td>
      <td>9.2</td>
      <td>Light Rain</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A-3</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:49:27</td>
      <td>2016-02-08 07:19:27</td>
      <td>0.01</td>
      <td>Williamsburg</td>
      <td>Clermont</td>
      <td>OH</td>
      <td>45176</td>
      <td>...</td>
      <td>36.0</td>
      <td>10.0</td>
      <td>3.5</td>
      <td>Overcast</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A-4</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 07:23:34</td>
      <td>2016-02-08 07:53:34</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45417</td>
      <td>...</td>
      <td>35.1</td>
      <td>9.0</td>
      <td>4.6</td>
      <td>Mostly Cloudy</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A-5</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 07:39:07</td>
      <td>2016-02-08 08:09:07</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45459</td>
      <td>...</td>
      <td>36.0</td>
      <td>6.0</td>
      <td>3.5</td>
      <td>Mostly Cloudy</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b040385a-7df1-4627-981c-1e83acd46f13')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b040385a-7df1-4627-981c-1e83acd46f13 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b040385a-7df1-4627-981c-1e83acd46f13');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-3af50132-1f13-47af-a713-ad818d59e11e">
      <button class="colab-df-quickchart" onclick="quickchart('df-3af50132-1f13-47af-a713-ad818d59e11e')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-3af50132-1f13-47af-a713-ad818d59e11e button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="26" id="hZFTvvIFcZs3">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Type Conversion</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Start_Time&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;End_Time&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;End_Time&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="27" id="-Xth4nhpcZmN">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#A clever way to take only date but not time + Drop End Time Column</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Start_Time&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>:<span class="dv">10</span>])</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>df.drop(columns<span class="op">=</span><span class="st">&#39;End_Time&#39;</span>,inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28" id="NPQWkKx2eNlr">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Datetime Conversion</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Start_Time&#39;</span>]<span class="op">=</span>pd.to_datetime(df[<span class="st">&#39;Start_Time&#39;</span>])</span></code></pre></div>
</div>
<div class="cell markdown" id="nmDDp_-AQG7a">
<p>###<strong>CUDF</strong></p>
</div>
<div class="cell markdown" id="EfjvHH7XQVa7">
<p>####<strong>Dropping Columns</strong></p>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ELY2QyRMRhkQ" data-outputId="fc287112-18dd-4f1d-d69d-1ddffdb451b6">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Drop Columns</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>start<span class="op">=</span>time.time()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>cf.drop(columns<span class="op">=</span>[<span class="st">&#39;Start_Lat&#39;</span>,<span class="st">&#39;Start_Lng&#39;</span>,<span class="st">&#39;End_Lat&#39;</span>,<span class="st">&#39;End_Lng&#39;</span>,<span class="st">&#39;Description&#39;</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Street&#39;</span>,<span class="st">&#39;Timezone&#39;</span>,<span class="st">&#39;Airport_Code&#39;</span>,<span class="st">&#39;Weather_Timestamp&#39;</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Wind_Chill(F)&#39;</span>,<span class="st">&#39;Humidity(%)&#39;</span>,<span class="st">&#39;Pressure(in)&#39;</span>,<span class="st">&#39;Wind_Direction&#39;</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Precipitation(in)&#39;</span>,<span class="st">&#39;Amenity&#39;</span>,<span class="st">&#39;Bump&#39;</span>,<span class="st">&#39;Junction&#39;</span>,<span class="st">&#39;No_Exit&#39;</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Station&#39;</span>,<span class="st">&#39;Traffic_Signal&#39;</span>,<span class="st">&#39;Turning_Loop&#39;</span>,<span class="st">&#39;Sunrise_Sunset&#39;</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Civil_Twilight&#39;</span>,<span class="st">&#39;Nautical_Twilight&#39;</span>,<span class="st">&#39;Astronomical_Twilight&#39;</span>],</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>end<span class="op">=</span>time.time()</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>end<span class="op">-</span>start<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.00
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="QRk0WjCDSHB-" data-outputId="79154fd9-1e09-403f-eb98-765353fef252">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>cf.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;cudf.core.dataframe.DataFrame&#39;&gt;
RangeIndex: 7728394 entries, 0 to 7728393
Data columns (total 21 columns):
 #   Column             Dtype
---  ------             -----
 0   ID                 object
 1   Source             object
 2   Severity           int64
 3   Start_Time         object
 4   End_Time           object
 5   Distance(mi)       float64
 6   City               object
 7   County             object
 8   State              object
 9   Zipcode            object
 10  Country            object
 11  Temperature(F)     float64
 12  Visibility(mi)     float64
 13  Wind_Speed(mph)    float64
 14  Weather_Condition  object
 15  Crossing           bool
 16  Give_Way           bool
 17  Railway            bool
 18  Roundabout         bool
 19  Stop               bool
 20  Traffic_Calming    bool
dtypes: bool(6), float64(4), int64(1), object(10)
memory usage: 1.3+ GB
</code></pre>
</div>
</div>
<div class="cell markdown" id="Ad_aVqGqSlH2">
<p>####<strong>Fillng Missing Values</strong></p>
</div>
<div class="cell markdown" id="wuAcfOrZSsMz">
<p>Again we will follow the same approach about filling with mean and
median but this time we we will consider the whole DataFrame.</p>
</div>
<div class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="mFBClXMPSqGi" data-outputId="57ffc730-a7e0-4482-8341-94b71fb4506a">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Start by Groupping</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>start<span class="op">=</span>time.time()</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>test2<span class="op">=</span>(cf.groupby(<span class="st">&#39;State&#39;</span>)[[<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]]</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a> .agg([<span class="st">&#39;mean&#39;</span>,<span class="st">&#39;median&#39;</span>]))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>end<span class="op">=</span>time.time()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>end<span class="op">-</span>start<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.87
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="p6dGenARU6e-" data-outputId="ee01d58a-ca1c-4e94-a849-5fcd34ed52cc">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Preview</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>test2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="32">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Temperature(F)</th>
      <th colspan="2" halign="left">Visibility(mi)</th>
      <th colspan="2" halign="left">Wind_Speed(mph)</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
      <th>mean</th>
      <th>median</th>
      <th>mean</th>
      <th>median</th>
    </tr>
    <tr>
      <th>State</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AL</th>
      <td>66.488167</td>
      <td>69.0</td>
      <td>9.094628</td>
      <td>10.0</td>
      <td>6.392209</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>AR</th>
      <td>59.852580</td>
      <td>61.0</td>
      <td>8.832653</td>
      <td>10.0</td>
      <td>7.074574</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>AZ</th>
      <td>72.654621</td>
      <td>73.0</td>
      <td>10.212332</td>
      <td>10.0</td>
      <td>7.118711</td>
      <td>6.9</td>
    </tr>
    <tr>
      <th>CA</th>
      <td>63.900452</td>
      <td>63.0</td>
      <td>9.089184</td>
      <td>10.0</td>
      <td>6.550965</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>CO</th>
      <td>47.536737</td>
      <td>46.9</td>
      <td>11.280650</td>
      <td>10.0</td>
      <td>8.511995</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="33"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Sg6CojLuTkvU" data-outputId="ccdd698b-2631-4672-fb21-65c90aec420b">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sample&#39;s Mean and Median</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Mean Median&#39;</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>cf[<span class="st">&#39;Temperature(F)&#39;</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss"> </span><span class="sc">{</span>cf[<span class="st">&#39;Temperature(F)&#39;</span>]<span class="sc">.</span>median()<span class="sc">:.1f}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>cf[<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">  </span><span class="sc">{</span>cf[<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="sc">.</span>median()<span class="sc">:.1f}</span><span class="ss">&quot;</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>cf[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">  </span><span class="sc">{</span>cf[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="sc">.</span>median()<span class="sc">:.1f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Mean Median
61.7 64.0
9.1  10.0
7.7  7.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="34" id="8v9JMa2DU989">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Percentage Difference for Median and Mean</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]:</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  test2[i<span class="op">+</span><span class="st">&#39;_pct&#39;</span>]<span class="op">=</span><span class="bu">abs</span>(test2[(i,<span class="st">&#39;mean&#39;</span>)]<span class="op">-</span>test2[(i,<span class="st">&#39;median&#39;</span>)])<span class="op">/</span>test2[(i,<span class="st">&#39;median&#39;</span>)]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="35" id="wV5XIM0hZa2c">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Masks</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]:</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  test2[i<span class="op">+</span><span class="st">&#39;_mask&#39;</span>]<span class="op">=</span>test2[i<span class="op">+</span><span class="st">&#39;_pct&#39;</span>]<span class="op">&gt;</span><span class="fl">0.02</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="36" id="HqvKHY8RZ3QW">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Dictionaries for Instant Access</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>temp_mean_dic2 <span class="op">=</span> test2[(<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>temp_median_dic2 <span class="op">=</span> test2[(<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>temp_mask_dic2 <span class="op">=</span> test2[<span class="st">&#39;Temperature(F)_mask&#39;</span>].to_dict()</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>vis_mean_dic2 <span class="op">=</span> test2[(<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>vis_median_dic2 <span class="op">=</span> test2[(<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>vis_mask_dic2 <span class="op">=</span> test2[<span class="st">&#39;Visibility(mi)_mask&#39;</span>].to_dict()</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>win_mean_dic2 <span class="op">=</span> test2[(<span class="st">&#39;Wind_Speed(mph)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>win_median_dic2 <span class="op">=</span> test2[(<span class="st">&#39;Wind_Speed(mph)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>win_mask_dic2 <span class="op">=</span> test2[<span class="st">&#39;Wind_Speed(mph)_mask&#39;</span>].to_dict()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="37"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="P0qyq0cwdVMO" data-outputId="8a4a17b1-b1a8-41c9-a23e-9da887301216">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>test2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">Temperature(F)</th>
      <th colspan="2" halign="left">Visibility(mi)</th>
      <th colspan="2" halign="left">Wind_Speed(mph)</th>
      <th>Temperature(F)_pct</th>
      <th>Visibility(mi)_pct</th>
      <th>Wind_Speed(mph)_pct</th>
      <th>Temperature(F)_mask</th>
      <th>Visibility(mi)_mask</th>
      <th>Wind_Speed(mph)_mask</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>median</th>
      <th>mean</th>
      <th>median</th>
      <th>mean</th>
      <th>median</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th>State</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AL</th>
      <td>66.488167</td>
      <td>69.0</td>
      <td>9.094628</td>
      <td>10.0</td>
      <td>6.392209</td>
      <td>6.0</td>
      <td>0.036403</td>
      <td>0.090537</td>
      <td>0.065368</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>AR</th>
      <td>59.852580</td>
      <td>61.0</td>
      <td>8.832653</td>
      <td>10.0</td>
      <td>7.074574</td>
      <td>7.0</td>
      <td>0.018810</td>
      <td>0.116735</td>
      <td>0.010653</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>AZ</th>
      <td>72.654621</td>
      <td>73.0</td>
      <td>10.212332</td>
      <td>10.0</td>
      <td>7.118711</td>
      <td>6.9</td>
      <td>0.004731</td>
      <td>0.021233</td>
      <td>0.031697</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>CA</th>
      <td>63.900452</td>
      <td>63.0</td>
      <td>9.089184</td>
      <td>10.0</td>
      <td>6.550965</td>
      <td>6.0</td>
      <td>0.014293</td>
      <td>0.091082</td>
      <td>0.091827</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
    <tr>
      <th>CO</th>
      <td>47.536737</td>
      <td>46.9</td>
      <td>11.280650</td>
      <td>10.0</td>
      <td>8.511995</td>
      <td>7.0</td>
      <td>0.013576</td>
      <td>0.128065</td>
      <td>0.215999</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown" id="P62wgkmk9Rnk">
<p>The apply-function is currently not working in cudf library. We will
use a vectorized approach.</p>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="KxdK1FVEBmD2" data-outputId="431fd18b-35b3-4b84-d062-686b35cf5063">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>start<span class="op">=</span>time.time()</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Temperature Fill</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>mask_temp<span class="op">=</span>cf[<span class="st">&#39;Temperature(F)&#39;</span>].isna()</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>use_median_temp<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(temp_mask_dic2)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>cf.loc[mask_temp <span class="op">&amp;</span> use_median_temp,<span class="st">&#39;Temperature(F)&#39;</span>]<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(temp_median_dic2)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>cf.loc[mask_temp <span class="op">&amp;</span> <span class="op">~</span>use_median_temp,<span class="st">&#39;Temperature(F)&#39;</span>]<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(temp_mean_dic2)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Visibility Fill</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>mask_vis<span class="op">=</span>cf[<span class="st">&#39;Visibility(mi)&#39;</span>].isna()</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>use_median_vis<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(vis_mask_dic2)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>cf.loc[mask_vis <span class="op">&amp;</span> use_median_vis,<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(vis_median_dic2)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>cf.loc[mask_vis <span class="op">&amp;</span> <span class="op">~</span>use_median_vis,<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(vis_mean_dic2)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Wind Speed Fill</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>mask_wind<span class="op">=</span>cf[<span class="st">&#39;Wind_Speed(mph)&#39;</span>].isna()</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>use_median_wind<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(win_mask_dic2)</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>cf.loc[mask_wind <span class="op">&amp;</span> use_median_wind,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(win_median_dic2)</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>cf.loc[mask_wind <span class="op">&amp;</span> <span class="op">~</span>use_median_wind,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="op">=</span>cf[<span class="st">&#39;State&#39;</span>].<span class="bu">map</span>(win_mean_dic2)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>end<span class="op">=</span>time.time()</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;</span><span class="sc">{</span>end<span class="op">-</span>start<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>0.61
</code></pre>
</div>
</div>
<div class="cell markdown" id="t_Kl1r1LJ_3P">
<p>####<strong>Droppping Remaining Null Values</strong></p>
</div>
<div class="cell code" data-execution_count="39"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="jIxVQVJY9fVi" data-outputId="2118eb3b-be1c-4938-9772-5d808d6f6a46">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Drop Remaining NA&#39;s</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>cf.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>cf.isna().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="39">
<pre><code>ID                   0
Source               0
Severity             0
Start_Time           0
End_Time             0
Distance(mi)         0
City                 0
County               0
State                0
Zipcode              0
Country              0
Temperature(F)       0
Visibility(mi)       0
Wind_Speed(mph)      0
Weather_Condition    0
Crossing             0
Give_Way             0
Railway              0
Roundabout           0
Stop                 0
Traffic_Calming      0
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="RM8v0r8XLp49">
<p>####<strong>Duplicates Check</strong></p>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="jWoEYKHW9fXj" data-outputId="7626097a-0922-4d9d-f225-72016d02028c">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Duplicates Check</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>cf.duplicated().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="40">
<pre><code>np.int64(0)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="41" id="_PCnCIOWL7Gg">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Resetting Index</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>cf.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="fEnGekxlPQe0">
<p>####<strong>Datetime Conversion</strong></p>
</div>
<div class="cell markdown" id="p6DrPPvGRURq">
<p>Conversion is triggering errors. This happens as the whole dataset
has mixxed types of time formats. However even this approach will
trigger arround 700k rows to get null values. We will find a different
approach for this. A simpler way is to perform time analysis in the GPU.
We will use regex to find dates that also include time. We will lose
700k rows since those rows only include date but not time.</p>
</div>
<div class="cell code" data-execution_count="42"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="lm7F7OKOAndE" data-outputId="d00d5a7a-14a7-4b3c-e2b6-8ddbc10786b8">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>cf.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="42">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>End_Time</th>
      <th>Distance(mi)</th>
      <th>City</th>
      <th>County</th>
      <th>State</th>
      <th>Zipcode</th>
      <th>...</th>
      <th>Temperature(F)</th>
      <th>Visibility(mi)</th>
      <th>Wind_Speed(mph)</th>
      <th>Weather_Condition</th>
      <th>Crossing</th>
      <th>Give_Way</th>
      <th>Railway</th>
      <th>Roundabout</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A-1</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 05:46:00</td>
      <td>2016-02-08 11:00:00</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45424</td>
      <td>...</td>
      <td>36.9</td>
      <td>10.0</td>
      <td>8.1</td>
      <td>Light Rain</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A-2</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:07:59</td>
      <td>2016-02-08 06:37:59</td>
      <td>0.01</td>
      <td>Reynoldsburg</td>
      <td>Franklin</td>
      <td>OH</td>
      <td>43068-3402</td>
      <td>...</td>
      <td>37.9</td>
      <td>10.0</td>
      <td>8.1</td>
      <td>Light Rain</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A-3</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:49:27</td>
      <td>2016-02-08 07:19:27</td>
      <td>0.01</td>
      <td>Williamsburg</td>
      <td>Clermont</td>
      <td>OH</td>
      <td>45176</td>
      <td>...</td>
      <td>36.0</td>
      <td>10.0</td>
      <td>3.5</td>
      <td>Overcast</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A-4</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 07:23:34</td>
      <td>2016-02-08 07:53:34</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45417</td>
      <td>...</td>
      <td>35.1</td>
      <td>9.0</td>
      <td>4.6</td>
      <td>Mostly Cloudy</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A-5</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 07:39:07</td>
      <td>2016-02-08 08:09:07</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45459</td>
      <td>...</td>
      <td>36.0</td>
      <td>6.0</td>
      <td>3.5</td>
      <td>Mostly Cloudy</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="SrCQzFhAHsGQ" data-outputId="1f48c10d-b056-4bfb-9482-5820d3dd1f7c">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Start + End Time Conversion</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>cf[<span class="st">&#39;Start_Time&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>cf[<span class="st">&#39;End_Time&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">
<pre><code>0          2016-02-08 11:00:00
1          2016-02-08 06:37:59
2          2016-02-08 07:19:27
3          2016-02-08 07:53:34
4          2016-02-08 08:09:07
                  ...         
7554688    2019-08-23 18:32:01
7554689    2019-08-23 19:38:23
7554690    2019-08-23 19:28:49
7554691    2019-08-23 19:29:42
7554692    2019-08-23 19:21:31
Name: End_Time, Length: 7554693, dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="44" id="fn_WtkMNUqTQ">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Masks with Regular Expressions</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>mas_start_time <span class="op">=</span> (cf[<span class="st">&#39;Start_Time&#39;</span>].<span class="bu">str</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                  .match(<span class="vs">r&#39;^\d</span><span class="sc">{4}</span><span class="vs">-\d</span><span class="sc">{2}</span><span class="vs">-\d</span><span class="sc">{2}</span><span class="vs"> \d</span><span class="sc">{2}</span><span class="vs">:\d</span><span class="sc">{2}</span><span class="vs">:\d</span><span class="sc">{2}</span><span class="vs">$&#39;</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>mas_end_time <span class="op">=</span> (cf[<span class="st">&#39;End_Time&#39;</span>].<span class="bu">str</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>                .match(<span class="vs">r&#39;^\d</span><span class="sc">{4}</span><span class="vs">-\d</span><span class="sc">{2}</span><span class="vs">-\d</span><span class="sc">{2}</span><span class="vs"> \d</span><span class="sc">{2}</span><span class="vs">:\d</span><span class="sc">{2}</span><span class="vs">:\d</span><span class="sc">{2}</span><span class="vs">$&#39;</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="45" id="hGv4Z1CkWIea">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>cf<span class="op">=</span>cf[mas_start_time <span class="op">&amp;</span> mas_end_time].reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="46" id="pNbA4iMkhm7J">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Datetime Conversion</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>cf[<span class="st">&#39;Start_Time&#39;</span>]<span class="op">=</span>cudf.to_datetime(cf[<span class="st">&#39;Start_Time&#39;</span>])</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>cf[<span class="st">&#39;End_Time&#39;</span>]<span class="op">=</span>cudf.to_datetime(cf[<span class="st">&#39;End_Time&#39;</span>])</span></code></pre></div>
</div>
<div class="cell markdown" id="FV3EdzAJhxKH">
<p>###<strong>Chunk Cleaning Function</strong> Since we are working with
chunks we need to define a cleaning function that combines all steps we
did in this section. This will clean every chunk.</p>
</div>
<div class="cell code" data-execution_count="47" id="wy-eNGpHjMNM">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cleaning Function</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_chunk(df):</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Drop Columns</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  df.drop(columns<span class="op">=</span>[<span class="st">&#39;Start_Lat&#39;</span>,<span class="st">&#39;Start_Lng&#39;</span>,<span class="st">&#39;End_Lat&#39;</span>,<span class="st">&#39;End_Lng&#39;</span>,<span class="st">&#39;Description&#39;</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Street&#39;</span>,<span class="st">&#39;Timezone&#39;</span>,<span class="st">&#39;Airport_Code&#39;</span>,<span class="st">&#39;Weather_Timestamp&#39;</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Wind_Chill(F)&#39;</span>,<span class="st">&#39;Humidity(%)&#39;</span>,<span class="st">&#39;Pressure(in)&#39;</span>,<span class="st">&#39;Wind_Direction&#39;</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Precipitation(in)&#39;</span>,<span class="st">&#39;Amenity&#39;</span>,<span class="st">&#39;Bump&#39;</span>,<span class="st">&#39;Junction&#39;</span>,<span class="st">&#39;No_Exit&#39;</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Station&#39;</span>,<span class="st">&#39;Traffic_Signal&#39;</span>,<span class="st">&#39;Turning_Loop&#39;</span>,<span class="st">&#39;Sunrise_Sunset&#39;</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&#39;Civil_Twilight&#39;</span>,<span class="st">&#39;Nautical_Twilight&#39;</span>,<span class="st">&#39;Astronomical_Twilight&#39;</span>],</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>        inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Filling Missing Values</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Making an instant GroupBy Analysis by State</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  test<span class="op">=</span>(df.groupby(<span class="st">&#39;State&#39;</span>)[[<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]]</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  .agg([<span class="st">&#39;mean&#39;</span>,<span class="st">&#39;median&#39;</span>]))</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculating Percentage Diffrence of mean and median</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> [<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]:</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    test[i<span class="op">+</span><span class="st">&#39;_pct&#39;</span>]<span class="op">=</span><span class="bu">abs</span>((test[(i,<span class="st">&#39;mean&#39;</span>)]<span class="op">-</span>test[(i,<span class="st">&#39;median&#39;</span>)]))<span class="op">/</span>test[(i,<span class="st">&#39;median&#39;</span>)]</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Creating a mask &gt;0.02%</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> [<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;Wind_Speed(mph)&#39;</span>]:</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>    test[i<span class="op">+</span><span class="st">&#39;_mask&#39;</span>]<span class="op">=</span>test[i<span class="op">+</span><span class="st">&#39;_pct&#39;</span>]<span class="op">&gt;</span><span class="fl">0.02</span></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Creating Dictionaries for mean,median and masks, to get easier access.</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  temp_mean_dic <span class="op">=</span> test[(<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  temp_median_dic <span class="op">=</span> test[(<span class="st">&#39;Temperature(F)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>  temp_mask_dic <span class="op">=</span> test[<span class="st">&#39;Temperature(F)_mask&#39;</span>].to_dict()</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>  vis_mean_dic <span class="op">=</span> test[(<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>  vis_median_dic <span class="op">=</span> test[(<span class="st">&#39;Visibility(mi)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>  vis_mask_dic <span class="op">=</span> test[<span class="st">&#39;Visibility(mi)_mask&#39;</span>].to_dict()</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>  win_mean_dic <span class="op">=</span> test[(<span class="st">&#39;Wind_Speed(mph)&#39;</span>,<span class="st">&#39;mean&#39;</span>)].to_dict()</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>  win_median_dic <span class="op">=</span> test[(<span class="st">&#39;Wind_Speed(mph)&#39;</span>,<span class="st">&#39;median&#39;</span>)].to_dict()</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>  win_mask_dic <span class="op">=</span> test[<span class="st">&#39;Wind_Speed(mph)_mask&#39;</span>].to_dict()</span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">#For Temperature</span></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> fill_temp(row):</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Temperature(F)&#39;</span>]):</span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> temp_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> temp_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> temp_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> row[<span class="st">&#39;Temperature(F)&#39;</span>]</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#For Visibility</span></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> fill_vis(row):</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Visibility(mi)&#39;</span>]):</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> vis_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> vis_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> vis_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> row[<span class="st">&#39;Visibility(mi)&#39;</span>]</span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">#For Wind Speed</span></span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> fill_wind(row):</span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(row[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]):</span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> win_mask_dic[row[<span class="st">&#39;State&#39;</span>]]:</span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> win_median_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> win_mean_dic[row[<span class="st">&#39;State&#39;</span>]]</span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> row[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]</span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Temperature(F)&#39;</span>] <span class="op">=</span> df.<span class="bu">apply</span>(fill_temp, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Visibility(mi)&#39;</span>] <span class="op">=</span> df.<span class="bu">apply</span>(fill_vis, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Wind_Speed(mph)&#39;</span>] <span class="op">=</span> df.<span class="bu">apply</span>(fill_wind, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Drop Remaining NA&#39;s</span></span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true" tabindex="-1"></a>  df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb67-77"><a href="#cb67-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-78"><a href="#cb67-78" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Drop Duplicates</span></span>
<span id="cb67-79"><a href="#cb67-79" aria-hidden="true" tabindex="-1"></a>  df.drop_duplicates(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb67-80"><a href="#cb67-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-81"><a href="#cb67-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Datetime Conversion</span></span>
<span id="cb67-82"><a href="#cb67-82" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Start_Time&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb67-83"><a href="#cb67-83" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;End_Time&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;End_Time&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb67-84"><a href="#cb67-84" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Start_Time&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>:<span class="dv">10</span>])</span>
<span id="cb67-85"><a href="#cb67-85" aria-hidden="true" tabindex="-1"></a>  df.drop(columns<span class="op">=</span><span class="st">&#39;End_Time&#39;</span>,inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb67-86"><a href="#cb67-86" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Start_Time&#39;</span>]<span class="op">=</span>pd.to_datetime(df[<span class="st">&#39;Start_Time&#39;</span>])</span>
<span id="cb67-87"><a href="#cb67-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-88"><a href="#cb67-88" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code></pre></div>
</div>
<div class="cell markdown" id="kWpZKSh_LcQa">
<p>##<strong>Step 4: Feature Engineering</strong> At this step we will
create useful features for our analysis.</p>
<p>For <strong>Pandas Dataframe</strong> we will:</p>
<ul>
<li>Add Year, Month, Day, Day_of_Week (with name)</li>
<li>Temperature Conversion from Fahrenheit to Celsius</li>
<li>Convert Miles to Kilometers in the corresponding columns</li>
<li>Make Temp_Bins (according to Clesius) as follows:
<ul>
<li>&lt; 0 --&gt; Very Cold</li>
<li>0-10 --&gt; Cold</li>
<li>10-18 --&gt; Cool-Mid Cool</li>
<li>18-24 --&gt; Mild-Comfortable</li>
<li>24-30 --&gt; Warm</li>
<li>30-35 --&gt; Hot</li>
<li>&gt; 35 --&gt; Very Hot</li>
</ul></li>
<li>Define a feature engineering function for every chunk</li>
</ul>
<p>For <strong>CUDF Dataframe</strong> we will perform time Analysis
only. We will create 3 columns.</p>
<ul>
<li>The time the incident lasted (it can be classified to bins but we
will come back later on the future about this since it is currently
outside of the scope of this project)</li>
<li>We will extract the hour of time</li>
<li>We will create hour bins
<ul>
<li>0-6 --&gt; Night</li>
<li>6-12 --&gt; Morning</li>
<li>12-18 --&gt; Afternoon</li>
<li>18-0 --&gt; Evening</li>
</ul></li>
</ul>
</div>
<div class="cell markdown" id="ru9gHc-gwKR9">
<p>###<strong>Pandas</strong></p>
</div>
<div class="cell code" data-execution_count="48" id="o8rPiOzYMZXt">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating New Columns</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting Dates</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Year&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].dt.year</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Month&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].dt.month_name()</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Day&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].dt.day</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Day_of_Week&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].dt.day_name()</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Fahrenheit -&gt; Celsius + Miles -&gt; Km</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Temperature(C)&#39;</span>]<span class="op">=</span>((df[<span class="st">&#39;Temperature(F)&#39;</span>]<span class="op">-</span><span class="dv">32</span>)<span class="op">*</span><span class="dv">5</span><span class="op">/</span><span class="dv">9</span>).<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Visbility(km)&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="op">*</span><span class="fl">1.60934</span>).<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Wind_Speed(km)&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="op">*</span><span class="fl">1.60934</span>).<span class="bu">round</span>(<span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="49" id="rWZFNX98MZnV">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Temperature Binning</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">min</span><span class="op">=</span>df[<span class="st">&#39;Temperature(C)&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="bu">max</span><span class="op">=</span>df[<span class="st">&#39;Temperature(C)&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>bins<span class="op">=</span>[<span class="bu">min</span><span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">18</span>,<span class="dv">24</span>,<span class="dv">30</span>,<span class="dv">35</span>,<span class="bu">max</span><span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">&#39;Very Cold&#39;</span>,<span class="st">&#39;Cold&#39;</span>,<span class="st">&#39;Cool-Mid Cool&#39;</span>,<span class="st">&#39;Mild-Comfortable&#39;</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Warm&#39;</span>,<span class="st">&#39;Hot&#39;</span>,<span class="st">&#39;Very Hot&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="50" id="0RQ2p9x3f4qv">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Temp Bins</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Temp_Bin&#39;</span>]<span class="op">=</span>pd.cut(df[<span class="st">&#39;Temperature(C)&#39;</span>],bins<span class="op">=</span>bins,labels<span class="op">=</span>labels)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="51"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="Vlw-QmdtMZVH" data-outputId="564d360f-a15b-4514-a9b0-d7d861bc7ad3">
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="51">

  <div id="df-ac0babf5-0cd0-46fc-bc88-a05d96c3c44c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>Distance(mi)</th>
      <th>City</th>
      <th>County</th>
      <th>State</th>
      <th>Zipcode</th>
      <th>Country</th>
      <th>...</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Day_of_Week</th>
      <th>Temperature(C)</th>
      <th>Visbility(km)</th>
      <th>Wind_Speed(km)</th>
      <th>Temp_Bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A-1</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45424</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>2.7</td>
      <td>16.1</td>
      <td>14.8</td>
      <td>Cold</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A-2</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Reynoldsburg</td>
      <td>Franklin</td>
      <td>OH</td>
      <td>43068-3402</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>3.3</td>
      <td>16.1</td>
      <td>14.8</td>
      <td>Cold</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A-3</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Williamsburg</td>
      <td>Clermont</td>
      <td>OH</td>
      <td>45176</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>2.2</td>
      <td>16.1</td>
      <td>5.6</td>
      <td>Cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A-4</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45417</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>1.7</td>
      <td>14.5</td>
      <td>7.4</td>
      <td>Cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A-5</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45459</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>2.2</td>
      <td>9.7</td>
      <td>5.6</td>
      <td>Cold</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ac0babf5-0cd0-46fc-bc88-a05d96c3c44c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ac0babf5-0cd0-46fc-bc88-a05d96c3c44c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ac0babf5-0cd0-46fc-bc88-a05d96c3c44c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-11fb1cc7-d694-4b68-9246-519a826958c7">
      <button class="colab-df-quickchart" onclick="quickchart('df-11fb1cc7-d694-4b68-9246-519a826958c7')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-11fb1cc7-d694-4b68-9246-519a826958c7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="2UCgf8VrXX7p">
<p>###<strong>Chunk Feature Engineering Function</strong></p>
</div>
<div class="cell code" data-execution_count="52" id="YLwFg6_e0mEz">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Feature Engineering Function for Chunk</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> feature_eng(df):</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Extracting Dates</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Year&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].dt.year</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Month&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].dt.month_name()</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Day&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].dt.day</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Day_of_Week&#39;</span>]<span class="op">=</span>df[<span class="st">&#39;Start_Time&#39;</span>].dt.day_name()</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Fahrenheit -&gt; Celsius + Miles -&gt; Km</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Temperature(C)&#39;</span>]<span class="op">=</span>((df[<span class="st">&#39;Temperature(F)&#39;</span>]<span class="op">-</span><span class="dv">32</span>)<span class="op">*</span><span class="dv">5</span><span class="op">/</span><span class="dv">9</span>).<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Visbility(km)&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;Visibility(mi)&#39;</span>]<span class="op">*</span><span class="fl">1.60934</span>).<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Wind_Speed(km)&#39;</span>]<span class="op">=</span>(df[<span class="st">&#39;Wind_Speed(mph)&#39;</span>]<span class="op">*</span><span class="fl">1.60934</span>).<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Temperature Binning</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="bu">min</span><span class="op">=</span>df[<span class="st">&#39;Temperature(C)&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="bu">max</span><span class="op">=</span>df[<span class="st">&#39;Temperature(C)&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  bins<span class="op">=</span>[<span class="bu">min</span><span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">18</span>,<span class="dv">24</span>,<span class="dv">30</span>,<span class="dv">35</span>,<span class="bu">max</span><span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  labels<span class="op">=</span>[<span class="st">&#39;Very Cold&#39;</span>,<span class="st">&#39;Cold&#39;</span>,<span class="st">&#39;Cool-Mid Cool&#39;</span>,<span class="st">&#39;Mild-Comfortable&#39;</span>,</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">&#39;Warm&#39;</span>,<span class="st">&#39;Hot&#39;</span>,<span class="st">&#39;Very Hot&#39;</span>]</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Temp Bins</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">&#39;Temp_Bin&#39;</span>]<span class="op">=</span>pd.cut(df[<span class="st">&#39;Temperature(C)&#39;</span>],bins<span class="op">=</span>bins,labels<span class="op">=</span>labels)</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> df</span></code></pre></div>
</div>
<div class="cell markdown" id="dGCufkIbwR6K">
<p>###<strong>CUDF</strong></p>
</div>
<div class="cell code" data-execution_count="53" id="hVTX0HKiwUfd">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Timedelta between Start_Time, End_time</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>cf[<span class="st">&#39;Time_Delta&#39;</span>]<span class="op">=</span>(cf[<span class="st">&#39;End_Time&#39;</span>]<span class="op">-</span>cf[<span class="st">&#39;Start_Time&#39;</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="54" id="nSQQ4Ikqx10W">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hour + Binning</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>cf[<span class="st">&#39;Hour&#39;</span>]<span class="op">=</span>cf[<span class="st">&#39;Start_Time&#39;</span>].dt.hour</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>bins<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">12</span>,<span class="dv">18</span>,<span class="dv">24</span>]</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">&#39;Night&#39;</span>,<span class="st">&#39;Morning&#39;</span>,<span class="st">&#39;Afternoon&#39;</span>,<span class="st">&#39;Evening&#39;</span>]</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>cf[<span class="st">&#39;Hour_Bin&#39;</span>]<span class="op">=</span>cudf.cut(cf[<span class="st">&#39;Hour&#39;</span>],bins<span class="op">=</span>bins,labels<span class="op">=</span>labels,right<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="55"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:0}"
id="jMhMphhRwUc9" data-outputId="5f09dbf3-982e-4695-ac38-63b35754a5c8">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>cf.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="55">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>End_Time</th>
      <th>Distance(mi)</th>
      <th>City</th>
      <th>County</th>
      <th>State</th>
      <th>Zipcode</th>
      <th>...</th>
      <th>Weather_Condition</th>
      <th>Crossing</th>
      <th>Give_Way</th>
      <th>Railway</th>
      <th>Roundabout</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
      <th>Time_Delta</th>
      <th>Hour</th>
      <th>Hour_Bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A-1</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 05:46:00</td>
      <td>2016-02-08 11:00:00</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45424</td>
      <td>...</td>
      <td>Light Rain</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 05:14:00</td>
      <td>5</td>
      <td>Night</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A-2</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:07:59</td>
      <td>2016-02-08 06:37:59</td>
      <td>0.01</td>
      <td>Reynoldsburg</td>
      <td>Franklin</td>
      <td>OH</td>
      <td>43068-3402</td>
      <td>...</td>
      <td>Light Rain</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:30:00</td>
      <td>6</td>
      <td>Morning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A-3</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:49:27</td>
      <td>2016-02-08 07:19:27</td>
      <td>0.01</td>
      <td>Williamsburg</td>
      <td>Clermont</td>
      <td>OH</td>
      <td>45176</td>
      <td>...</td>
      <td>Overcast</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:30:00</td>
      <td>6</td>
      <td>Morning</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A-4</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 07:23:34</td>
      <td>2016-02-08 07:53:34</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45417</td>
      <td>...</td>
      <td>Mostly Cloudy</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:30:00</td>
      <td>7</td>
      <td>Morning</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A-5</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 07:39:07</td>
      <td>2016-02-08 08:09:07</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45459</td>
      <td>...</td>
      <td>Mostly Cloudy</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:30:00</td>
      <td>7</td>
      <td>Morning</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
</div>
</div>
<div class="cell markdown" id="ujV4S8S4zj3h">
<p>##<strong>Step 5: Statistical Analysis</strong> At this step we will
perfrom a groupby analysis where general analysis will occur from Pandas
Dataframe and Time Analysis from CUDF Dataframe.</p>
</div>
<div class="cell markdown" id="MMx6ejBd9w5Q">
<p>###<strong>Pandas</strong></p>
</div>
<div class="cell code" data-execution_count="56"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:342}"
id="IuqxhcVa0E-W" data-outputId="6b25b106-7986-46fe-f1f1-72e7da66d768">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="56">

  <div id="df-d8e98a3c-acb3-4c5d-a27c-743eaac23b90" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>Distance(mi)</th>
      <th>City</th>
      <th>County</th>
      <th>State</th>
      <th>Zipcode</th>
      <th>Country</th>
      <th>...</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
      <th>Year</th>
      <th>Month</th>
      <th>Day</th>
      <th>Day_of_Week</th>
      <th>Temperature(C)</th>
      <th>Visbility(km)</th>
      <th>Wind_Speed(km)</th>
      <th>Temp_Bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A-1</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45424</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>2.7</td>
      <td>16.1</td>
      <td>14.8</td>
      <td>Cold</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A-2</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Reynoldsburg</td>
      <td>Franklin</td>
      <td>OH</td>
      <td>43068-3402</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>3.3</td>
      <td>16.1</td>
      <td>14.8</td>
      <td>Cold</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A-3</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Williamsburg</td>
      <td>Clermont</td>
      <td>OH</td>
      <td>45176</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>2.2</td>
      <td>16.1</td>
      <td>5.6</td>
      <td>Cold</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A-4</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45417</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>1.7</td>
      <td>14.5</td>
      <td>7.4</td>
      <td>Cold</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A-5</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45459</td>
      <td>US</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>2016</td>
      <td>February</td>
      <td>8</td>
      <td>Monday</td>
      <td>2.2</td>
      <td>9.7</td>
      <td>5.6</td>
      <td>Cold</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d8e98a3c-acb3-4c5d-a27c-743eaac23b90')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d8e98a3c-acb3-4c5d-a27c-743eaac23b90 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d8e98a3c-acb3-4c5d-a27c-743eaac23b90');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-833bf78c-58da-43db-80b8-068cc1b811cb">
      <button class="colab-df-quickchart" onclick="quickchart('df-833bf78c-58da-43db-80b8-068cc1b811cb')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-833bf78c-58da-43db-80b8-068cc1b811cb button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="xz-ENa--5ga-">
<p>####<strong>General Analysis</strong></p>
</div>
<div class="cell code" data-execution_count="57"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:959}"
id="fugb2P9r0p7b" data-outputId="db43ae2d-db5c-40b6-e65a-bd3cce9e74e3">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#State with most accidents</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>kf1<span class="op">=</span>(df.groupby(<span class="st">&#39;State&#39;</span>).size().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    .reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>))</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>kf1</span></code></pre></div>
<div class="output execute_result" data-execution_count="57">

  <div id="df-7682606a-753d-4cfe-842f-125a3a89f3a8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>172237</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TX</td>
      <td>76165</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>49027</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PA</td>
      <td>30440</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MI</td>
      <td>25069</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NY</td>
      <td>24803</td>
    </tr>
    <tr>
      <th>6</th>
      <td>GA</td>
      <td>18482</td>
    </tr>
    <tr>
      <th>7</th>
      <td>IL</td>
      <td>17096</td>
    </tr>
    <tr>
      <th>8</th>
      <td>OH</td>
      <td>11469</td>
    </tr>
    <tr>
      <th>9</th>
      <td>WA</td>
      <td>11266</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NE</td>
      <td>8276</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NJ</td>
      <td>8072</td>
    </tr>
    <tr>
      <th>12</th>
      <td>MD</td>
      <td>7946</td>
    </tr>
    <tr>
      <th>13</th>
      <td>VA</td>
      <td>7776</td>
    </tr>
    <tr>
      <th>14</th>
      <td>MA</td>
      <td>7212</td>
    </tr>
    <tr>
      <th>15</th>
      <td>CT</td>
      <td>4097</td>
    </tr>
    <tr>
      <th>16</th>
      <td>SC</td>
      <td>4039</td>
    </tr>
    <tr>
      <th>17</th>
      <td>IA</td>
      <td>1992</td>
    </tr>
    <tr>
      <th>18</th>
      <td>MO</td>
      <td>1911</td>
    </tr>
    <tr>
      <th>19</th>
      <td>RI</td>
      <td>1523</td>
    </tr>
    <tr>
      <th>20</th>
      <td>DC</td>
      <td>403</td>
    </tr>
    <tr>
      <th>21</th>
      <td>NH</td>
      <td>152</td>
    </tr>
    <tr>
      <th>22</th>
      <td>DE</td>
      <td>114</td>
    </tr>
    <tr>
      <th>23</th>
      <td>WI</td>
      <td>68</td>
    </tr>
    <tr>
      <th>24</th>
      <td>OR</td>
      <td>62</td>
    </tr>
    <tr>
      <th>25</th>
      <td>WV</td>
      <td>44</td>
    </tr>
    <tr>
      <th>26</th>
      <td>IN</td>
      <td>43</td>
    </tr>
    <tr>
      <th>27</th>
      <td>KY</td>
      <td>6</td>
    </tr>
    <tr>
      <th>28</th>
      <td>AL</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7682606a-753d-4cfe-842f-125a3a89f3a8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7682606a-753d-4cfe-842f-125a3a89f3a8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7682606a-753d-4cfe-842f-125a3a89f3a8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-7ba352de-8b53-443a-b1bc-d972ba4fb191">
      <button class="colab-df-quickchart" onclick="quickchart('df-7ba352de-8b53-443a-b1bc-d972ba4fb191')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-7ba352de-8b53-443a-b1bc-d972ba4fb191 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_c4862328-a978-49c7-aa87-7dcba663e7b0">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf1')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_c4862328-a978-49c7-aa87-7dcba663e7b0 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf1');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="58"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:959}"
id="GryqN5an1Bez" data-outputId="170e75f8-c96f-4304-8e21-952621ec9d7a">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">#County of each state with most crashes</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>kf2<span class="op">=</span>(df.groupby([<span class="st">&#39;State&#39;</span>,<span class="st">&#39;County&#39;</span>]).size()</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    .reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;State&#39;</span>).head(<span class="dv">1</span>))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>kf2</span></code></pre></div>
<div class="output execute_result" data-execution_count="58">

  <div id="df-77667aac-128d-4f86-af39-6bffa51e13aa" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>County</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>CA</td>
      <td>Los Angeles</td>
      <td>61721</td>
    </tr>
    <tr>
      <th>641</th>
      <td>TX</td>
      <td>Harris</td>
      <td>27181</td>
    </tr>
    <tr>
      <th>582</th>
      <td>PA</td>
      <td>Montgomery</td>
      <td>13990</td>
    </tr>
    <tr>
      <th>377</th>
      <td>MI</td>
      <td>Genesee</td>
      <td>9276</td>
    </tr>
    <tr>
      <th>80</th>
      <td>FL</td>
      <td>Orange</td>
      <td>8659</td>
    </tr>
    <tr>
      <th>131</th>
      <td>GA</td>
      <td>Fulton</td>
      <td>8017</td>
    </tr>
    <tr>
      <th>705</th>
      <td>WA</td>
      <td>King</td>
      <td>7530</td>
    </tr>
    <tr>
      <th>428</th>
      <td>NE</td>
      <td>Douglas</td>
      <td>6856</td>
    </tr>
    <tr>
      <th>518</th>
      <td>OH</td>
      <td>Montgomery</td>
      <td>6001</td>
    </tr>
    <tr>
      <th>479</th>
      <td>NY</td>
      <td>Westchester</td>
      <td>5474</td>
    </tr>
    <tr>
      <th>270</th>
      <td>IL</td>
      <td>DuPage</td>
      <td>4662</td>
    </tr>
    <tr>
      <th>682</th>
      <td>VA</td>
      <td>Fairfax County</td>
      <td>3385</td>
    </tr>
    <tr>
      <th>337</th>
      <td>MA</td>
      <td>Middlesex</td>
      <td>3099</td>
    </tr>
    <tr>
      <th>357</th>
      <td>MD</td>
      <td>Montgomery</td>
      <td>1757</td>
    </tr>
    <tr>
      <th>602</th>
      <td>SC</td>
      <td>Aiken</td>
      <td>1469</td>
    </tr>
    <tr>
      <th>43</th>
      <td>CT</td>
      <td>Hartford</td>
      <td>1373</td>
    </tr>
    <tr>
      <th>424</th>
      <td>MO</td>
      <td>St. Louis County</td>
      <td>1286</td>
    </tr>
    <tr>
      <th>443</th>
      <td>NJ</td>
      <td>Essex</td>
      <td>1268</td>
    </tr>
    <tr>
      <th>599</th>
      <td>RI</td>
      <td>Providence</td>
      <td>1162</td>
    </tr>
    <tr>
      <th>242</th>
      <td>IA</td>
      <td>Polk</td>
      <td>939</td>
    </tr>
    <tr>
      <th>51</th>
      <td>DC</td>
      <td>District of Columbia</td>
      <td>340</td>
    </tr>
    <tr>
      <th>54</th>
      <td>DE</td>
      <td>New Castle</td>
      <td>107</td>
    </tr>
    <tr>
      <th>435</th>
      <td>NH</td>
      <td>Hillsborough</td>
      <td>105</td>
    </tr>
    <tr>
      <th>544</th>
      <td>OR</td>
      <td>Columbia</td>
      <td>43</td>
    </tr>
    <tr>
      <th>725</th>
      <td>WI</td>
      <td>Kenosha</td>
      <td>39</td>
    </tr>
    <tr>
      <th>324</th>
      <td>IN</td>
      <td>Lake</td>
      <td>31</td>
    </tr>
    <tr>
      <th>729</th>
      <td>WV</td>
      <td>Berkeley</td>
      <td>19</td>
    </tr>
    <tr>
      <th>329</th>
      <td>KY</td>
      <td>Greenup</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>Russell</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-77667aac-128d-4f86-af39-6bffa51e13aa')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-77667aac-128d-4f86-af39-6bffa51e13aa button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-77667aac-128d-4f86-af39-6bffa51e13aa');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-9cc3d88d-3e40-4817-830a-e705b77bf978">
      <button class="colab-df-quickchart" onclick="quickchart('df-9cc3d88d-3e40-4817-830a-e705b77bf978')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-9cc3d88d-3e40-4817-830a-e705b77bf978 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_e690c4d1-762a-4fbe-9268-5aed30103227">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf2')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_e690c4d1-762a-4fbe-9268-5aed30103227 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf2');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="59"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:125}"
id="4yYaa5W01_bS" data-outputId="6167de1d-3793-4f5a-9b7f-4dd150507a09">
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents per Year</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>kf3<span class="op">=</span>(df.groupby(<span class="st">&#39;Year&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>))</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>kf3</span></code></pre></div>
<div class="output execute_result" data-execution_count="59">

  <div id="df-30a846cd-86df-4d3e-84ae-09e44660cf97" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>275686</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>214108</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-30a846cd-86df-4d3e-84ae-09e44660cf97')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-30a846cd-86df-4d3e-84ae-09e44660cf97 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-30a846cd-86df-4d3e-84ae-09e44660cf97');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-4ac8f84c-aab3-4b41-9797-7cbe586e9483">
      <button class="colab-df-quickchart" onclick="quickchart('df-4ac8f84c-aab3-4b41-9797-7cbe586e9483')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-4ac8f84c-aab3-4b41-9797-7cbe586e9483 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_18c2ce7d-2e2f-4fd3-b7a3-4820f74e200b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf3')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_18c2ce7d-2e2f-4fd3-b7a3-4820f74e200b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf3');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="60"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:426}"
id="UOTBqmcZ5oq4" data-outputId="e2aaaed7-7843-4a9d-e528-d5864d178588">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents per Month</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>kf4<span class="op">=</span>(df.groupby(<span class="st">&#39;Month&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>kf4</span></code></pre></div>
<div class="output execute_result" data-execution_count="60">

  <div id="df-953bb8de-e317-4437-b455-4678a4f77d16" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>June</td>
      <td>51464</td>
    </tr>
    <tr>
      <th>9</th>
      <td>November</td>
      <td>45463</td>
    </tr>
    <tr>
      <th>0</th>
      <td>April</td>
      <td>44877</td>
    </tr>
    <tr>
      <th>5</th>
      <td>July</td>
      <td>43856</td>
    </tr>
    <tr>
      <th>7</th>
      <td>March</td>
      <td>42536</td>
    </tr>
    <tr>
      <th>2</th>
      <td>December</td>
      <td>39817</td>
    </tr>
    <tr>
      <th>11</th>
      <td>September</td>
      <td>38852</td>
    </tr>
    <tr>
      <th>1</th>
      <td>August</td>
      <td>37859</td>
    </tr>
    <tr>
      <th>4</th>
      <td>January</td>
      <td>37729</td>
    </tr>
    <tr>
      <th>10</th>
      <td>October</td>
      <td>37250</td>
    </tr>
    <tr>
      <th>8</th>
      <td>May</td>
      <td>35122</td>
    </tr>
    <tr>
      <th>3</th>
      <td>February</td>
      <td>34969</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-953bb8de-e317-4437-b455-4678a4f77d16')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-953bb8de-e317-4437-b455-4678a4f77d16 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-953bb8de-e317-4437-b455-4678a4f77d16');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-d482533e-f064-483c-8224-833c78fe36e4">
      <button class="colab-df-quickchart" onclick="quickchart('df-d482533e-f064-483c-8224-833c78fe36e4')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-d482533e-f064-483c-8224-833c78fe36e4 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_c5082b10-66d5-4b42-98b2-4e8904fecfaa">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf4')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_c5082b10-66d5-4b42-98b2-4e8904fecfaa button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf4');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="61"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}"
id="NAxEch1m6Alo" data-outputId="f7dd7fcb-506d-4618-d3a8-b9cef2380a4a">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents per day of week</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>kf5<span class="op">=</span>(df.groupby(<span class="st">&#39;Day_of_Week&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>kf5</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">

  <div id="df-06df8757-161b-491f-8b01-3e587289ecd0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Day_of_Week</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>Thursday</td>
      <td>88453</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tuesday</td>
      <td>87887</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Wednesday</td>
      <td>87567</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Friday</td>
      <td>85540</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Monday</td>
      <td>82243</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Saturday</td>
      <td>30828</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sunday</td>
      <td>27276</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-06df8757-161b-491f-8b01-3e587289ecd0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-06df8757-161b-491f-8b01-3e587289ecd0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-06df8757-161b-491f-8b01-3e587289ecd0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-5e07a1fc-aa5c-4721-8796-88a7e15a0d17">
      <button class="colab-df-quickchart" onclick="quickchart('df-5e07a1fc-aa5c-4721-8796-88a7e15a0d17')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-5e07a1fc-aa5c-4721-8796-88a7e15a0d17 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_68fd6b7e-1425-4db5-8564-5b16dfad3cfe">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf5')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_68fd6b7e-1425-4db5-8564-5b16dfad3cfe button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf5');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="62"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:324}"
id="GmBx18kL7H9Y" data-outputId="2149e477-63dd-4f62-a38d-f2adf62bbe8e">
<div class="sourceCode" id="cb82"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents per Temperature Bin</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>kf6<span class="op">=</span>(df.groupby(<span class="st">&#39;Temp_Bin&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>kf6</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-826879175.py:2: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="62">

  <div id="df-cad00c61-f724-406c-ba88-bcabbffbf157" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temp_Bin</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Cool-Mid Cool</td>
      <td>133204</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mild-Comfortable</td>
      <td>126897</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Warm</td>
      <td>100064</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cold</td>
      <td>68705</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hot</td>
      <td>33593</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Very Cold</td>
      <td>22939</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Very Hot</td>
      <td>4392</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cad00c61-f724-406c-ba88-bcabbffbf157')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cad00c61-f724-406c-ba88-bcabbffbf157 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cad00c61-f724-406c-ba88-bcabbffbf157');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-01c6a0f2-6a01-4d89-8edf-3be216f2617a">
      <button class="colab-df-quickchart" onclick="quickchart('df-01c6a0f2-6a01-4d89-8edf-3be216f2617a')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-01c6a0f2-6a01-4d89-8edf-3be216f2617a button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_5e55bcdd-de38-430c-9b95-ca07f2812afe">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf6')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_5e55bcdd-de38-430c-9b95-ca07f2812afe button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf6');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="iSqgJM7MBPRl">
<p>####<strong>Multivariable Analysis</strong></p>
</div>
<div class="cell code" data-execution_count="63"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:238}"
id="CVXeda-jBTy5" data-outputId="7f56b52a-8a1a-4910-fe32-e39d9ccacf8b">
<div class="sourceCode" id="cb84"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Accidents by Year and State (Top3 States)</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>kf7<span class="op">=</span>(df.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;State&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">3</span>))</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>kf7</span></code></pre></div>
<div class="output execute_result" data-execution_count="63">

  <div id="df-5c62d261-c35b-4d3c-9a95-a20f9fada7f0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>State</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>CA</td>
      <td>104240</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2016</td>
      <td>TX</td>
      <td>39517</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016</td>
      <td>FL</td>
      <td>26434</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2017</td>
      <td>CA</td>
      <td>67997</td>
    </tr>
    <tr>
      <th>52</th>
      <td>2017</td>
      <td>TX</td>
      <td>36648</td>
    </tr>
    <tr>
      <th>33</th>
      <td>2017</td>
      <td>FL</td>
      <td>22593</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5c62d261-c35b-4d3c-9a95-a20f9fada7f0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5c62d261-c35b-4d3c-9a95-a20f9fada7f0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5c62d261-c35b-4d3c-9a95-a20f9fada7f0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-50fd0f66-aa2e-452e-bac4-1680dbcda95f">
      <button class="colab-df-quickchart" onclick="quickchart('df-50fd0f66-aa2e-452e-bac4-1680dbcda95f')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-50fd0f66-aa2e-452e-bac4-1680dbcda95f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_28727a17-4951-4254-8b69-f6af2f8ba8e2">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf7')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_28727a17-4951-4254-8b69-f6af2f8ba8e2 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf7');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="64"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:238}"
id="TSjK1ln7BT1g" data-outputId="2b7b93e6-2755-4ebe-b183-a740358edfca">
<div class="sourceCode" id="cb85"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Accidents by Year and Month (Top3 Months)</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>kf8<span class="op">=</span>(df.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Month&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">3</span>))</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>kf8</span></code></pre></div>
<div class="output execute_result" data-execution_count="64">

  <div id="df-9f507f7e-b515-4a60-8012-dc46cd548d59" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>2016</td>
      <td>November</td>
      <td>45463</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016</td>
      <td>December</td>
      <td>39817</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2016</td>
      <td>September</td>
      <td>38852</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2017</td>
      <td>March</td>
      <td>38720</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2017</td>
      <td>January</td>
      <td>37729</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2017</td>
      <td>February</td>
      <td>34544</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9f507f7e-b515-4a60-8012-dc46cd548d59')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9f507f7e-b515-4a60-8012-dc46cd548d59 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9f507f7e-b515-4a60-8012-dc46cd548d59');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-ca9856e5-189d-40a0-974f-d029fab6f757">
      <button class="colab-df-quickchart" onclick="quickchart('df-ca9856e5-189d-40a0-974f-d029fab6f757')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-ca9856e5-189d-40a0-974f-d029fab6f757 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_1b1541e7-2a20-403f-b85a-6c28a68d18ff">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf8')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_1b1541e7-2a20-403f-b85a-6c28a68d18ff button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf8');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="65"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:488}"
id="5Ccm0Mn2HQxT" data-outputId="08a91e14-600e-471e-f90a-713f61b328cc">
<div class="sourceCode" id="cb86"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Accidents by Year and Day-of-Week</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>kf9<span class="op">=</span>(df.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Day_of_Week&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">7</span>))</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>kf9</span></code></pre></div>
<div class="output execute_result" data-execution_count="65">

  <div id="df-765732d1-a3f0-4e55-a0b8-2abbde78be31" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Day_of_Week</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>2016</td>
      <td>Tuesday</td>
      <td>51106</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2016</td>
      <td>Wednesday</td>
      <td>50642</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016</td>
      <td>Thursday</td>
      <td>50511</td>
    </tr>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>Friday</td>
      <td>46950</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>Monday</td>
      <td>46337</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016</td>
      <td>Saturday</td>
      <td>16162</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016</td>
      <td>Sunday</td>
      <td>13978</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2017</td>
      <td>Friday</td>
      <td>38590</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2017</td>
      <td>Thursday</td>
      <td>37942</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2017</td>
      <td>Wednesday</td>
      <td>36925</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2017</td>
      <td>Tuesday</td>
      <td>36781</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2017</td>
      <td>Monday</td>
      <td>35906</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2017</td>
      <td>Saturday</td>
      <td>14666</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2017</td>
      <td>Sunday</td>
      <td>13298</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-765732d1-a3f0-4e55-a0b8-2abbde78be31')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-765732d1-a3f0-4e55-a0b8-2abbde78be31 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-765732d1-a3f0-4e55-a0b8-2abbde78be31');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-b7bcbe09-d770-4558-b031-9cf0e5392b3e">
      <button class="colab-df-quickchart" onclick="quickchart('df-b7bcbe09-d770-4558-b031-9cf0e5392b3e')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-b7bcbe09-d770-4558-b031-9cf0e5392b3e button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_c582f8b2-8f3c-4d84-8c7e-d8f8d7e57312">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf9')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_c582f8b2-8f3c-4d84-8c7e-d8f8d7e57312 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf9');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="66"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:292}"
id="ntU2GO-WK1zy" data-outputId="b2c753b6-75a7-4278-fbd6-510d73494e32">
<div class="sourceCode" id="cb87"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#By Year + Temp Bin (Top3 Weather Bins)</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>kf10<span class="op">=</span>(df.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Temp_Bin&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>      .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">3</span>))</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>kf10</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2859362990.py:2: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="66">

  <div id="df-284305e4-ae6f-4302-83b2-289cacb6e01a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Temp_Bin</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2016</td>
      <td>Mild-Comfortable</td>
      <td>75469</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016</td>
      <td>Cool-Mid Cool</td>
      <td>67784</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016</td>
      <td>Warm</td>
      <td>65555</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2017</td>
      <td>Cool-Mid Cool</td>
      <td>65420</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2017</td>
      <td>Mild-Comfortable</td>
      <td>51428</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2017</td>
      <td>Cold</td>
      <td>38365</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-284305e4-ae6f-4302-83b2-289cacb6e01a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-284305e4-ae6f-4302-83b2-289cacb6e01a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-284305e4-ae6f-4302-83b2-289cacb6e01a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-fe4ca638-9d40-4081-a5ca-0ef1122cc5e5">
      <button class="colab-df-quickchart" onclick="quickchart('df-fe4ca638-9d40-4081-a5ca-0ef1122cc5e5')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-fe4ca638-9d40-4081-a5ca-0ef1122cc5e5 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_0aeaf121-ae1e-429e-86de-bf8fdc200ed8">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('kf10')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_0aeaf121-ae1e-429e-86de-bf8fdc200ed8 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('kf10');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="_V31Ocbb_xu9">
<p>####<strong>Conclusion from all chunks</strong></p>
</div>
<div class="cell markdown" id="qFo6tshkNjjG">
<p>As you've seen all theese results do come from the first chunk.
Above's code seems to work well so now we need to embed the other chunks
as well. For each result above we created a dataframe. So the approach
is to create the same number of lists as the dataframes above and each
list contain the similar groupby analysis performed on every chunk. Then
for each list we will concat all the included dataframes.</p>
</div>
<div class="cell code" data-execution_count="67"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="3trKvM_NP1gA" data-outputId="1cfcac17-f855-4626-aa18-93f4197eed05">
<div class="sourceCode" id="cb89"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>start<span class="op">=</span>time.time()</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating The Loop for analyzing all the dataset</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>KF1<span class="op">=</span>[]</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>KF2<span class="op">=</span>[]</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>KF3<span class="op">=</span>[]</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>KF4<span class="op">=</span>[]</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>KF5<span class="op">=</span>[]</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>KF6<span class="op">=</span>[]</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>KF7<span class="op">=</span>[]</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>KF8<span class="op">=</span>[]</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>KF9<span class="op">=</span>[]</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>KF10<span class="op">=</span>[]</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>chunker <span class="op">=</span> pd.read_csv(file_path, chunksize<span class="op">=</span><span class="dv">500000</span>) <span class="co">#Creating the chunker again</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> df <span class="kw">in</span> chunker:</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  clean_chunk(df) <span class="co">#Cleaning Chunk</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  feature_eng(df) <span class="co">#Feature Engineering Chunk</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#State with most accidents</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>  kf1<span class="op">=</span>(df.groupby(<span class="st">&#39;State&#39;</span>).size().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>      .reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>))</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>  KF1.append(kf1)</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#County of each state with most crashes</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>  kf2<span class="op">=</span>(df.groupby([<span class="st">&#39;State&#39;</span>,<span class="st">&#39;County&#39;</span>]).size()</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>      .reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>).sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>      .groupby(<span class="st">&#39;State&#39;</span>).head(<span class="dv">1</span>))</span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>  KF2.append(kf2)</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Accidents per Year</span></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>  kf3<span class="op">=</span>(df.groupby(<span class="st">&#39;Year&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>))</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>  KF3.append(kf3)</span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Accidents per Month</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>  kf4<span class="op">=</span>(df.groupby(<span class="st">&#39;Month&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a>  KF4.append(kf4)</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Accidents per day of week</span></span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a>  kf5<span class="op">=</span>(df.groupby(<span class="st">&#39;Day_of_Week&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>  KF5.append(kf5)</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Accidents per Temperature Bin</span></span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a>  kf6<span class="op">=</span>(df.groupby(<span class="st">&#39;Temp_Bin&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb89-53"><a href="#cb89-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-54"><a href="#cb89-54" aria-hidden="true" tabindex="-1"></a>  KF6.append(kf6)</span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Most Accidents by Year and State (Top3 States)</span></span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a>  kf7<span class="op">=</span>(df.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;State&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a>      .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">3</span>))</span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a>  KF7.append(kf7)</span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Most Accidents by Year and Month (Top3 Months)</span></span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true" tabindex="-1"></a>  kf8<span class="op">=</span>(df.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Month&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true" tabindex="-1"></a>      .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">3</span>))</span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true" tabindex="-1"></a>  KF8.append(kf8)</span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Most Accidents by Year and Day-of-Week</span></span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true" tabindex="-1"></a>  kf9<span class="op">=</span>(df.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Day_of_Week&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb89-72"><a href="#cb89-72" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb89-73"><a href="#cb89-73" aria-hidden="true" tabindex="-1"></a>      .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">7</span>))</span>
<span id="cb89-74"><a href="#cb89-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-75"><a href="#cb89-75" aria-hidden="true" tabindex="-1"></a>  KF9.append(kf9)</span>
<span id="cb89-76"><a href="#cb89-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-77"><a href="#cb89-77" aria-hidden="true" tabindex="-1"></a>  <span class="co">#By Year + Temp Bin (Top3 Weather Bins)</span></span>
<span id="cb89-78"><a href="#cb89-78" aria-hidden="true" tabindex="-1"></a>  kf10<span class="op">=</span>(df.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Temp_Bin&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb89-79"><a href="#cb89-79" aria-hidden="true" tabindex="-1"></a>        .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb89-80"><a href="#cb89-80" aria-hidden="true" tabindex="-1"></a>        .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">3</span>))</span>
<span id="cb89-81"><a href="#cb89-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-82"><a href="#cb89-82" aria-hidden="true" tabindex="-1"></a>  KF10.append(kf10)</span>
<span id="cb89-83"><a href="#cb89-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-84"><a href="#cb89-84" aria-hidden="true" tabindex="-1"></a>end<span class="op">=</span>time.time()</span>
<span id="cb89-85"><a href="#cb89-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;The time it took was: </span><span class="sc">{</span>end<span class="op">-</span>start<span class="sc">:.2f}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>The time it took was: 256.20
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-12110409.py:51: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf6=(df.groupby(&#39;Temp_Bin&#39;).size().reset_index(name=&#39;Count&#39;)
/tmp/ipython-input-12110409.py:78: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  kf10=(df.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;]).size().reset_index(name=&#39;Count&#39;)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="68" id="y_MTgNWr5pAx">
<div class="sourceCode" id="cb93"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Concatenating all the above DataFrames in each list</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>KF1<span class="op">=</span>pd.concat(KF1, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>KF2<span class="op">=</span>pd.concat(KF2, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>KF3<span class="op">=</span>pd.concat(KF3, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>KF4<span class="op">=</span>pd.concat(KF4, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>KF5<span class="op">=</span>pd.concat(KF5, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>KF6<span class="op">=</span>pd.concat(KF6, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>KF7<span class="op">=</span>pd.concat(KF7, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>KF8<span class="op">=</span>pd.concat(KF8, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>KF9<span class="op">=</span>pd.concat(KF9, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>KF10<span class="op">=</span>pd.concat(KF10, axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="mEtSOyPW8itN">
<p>Now since all data are collected and merged from each dataframe it's
time to get the final results.</p>
</div>
<div class="cell code" data-execution_count="69"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="w5Ee4dCR7f-Y" data-outputId="1ef1974c-bba3-4f14-e81d-d2f3f34e1905">
<div class="sourceCode" id="cb94"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#State with most accidents</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>KF1<span class="op">=</span>(KF1.groupby(<span class="st">&#39;State&#39;</span>)[<span class="st">&#39;Count&#39;</span>]</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">sum</span>().reset_index()</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>     .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>KF1</span></code></pre></div>
<div class="output execute_result" data-execution_count="69">

  <div id="df-1002f592-005c-405a-b2ae-b714adb62627" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>CA</td>
      <td>1701644</td>
    </tr>
    <tr>
      <th>8</th>
      <td>FL</td>
      <td>870259</td>
    </tr>
    <tr>
      <th>41</th>
      <td>TX</td>
      <td>573638</td>
    </tr>
    <tr>
      <th>38</th>
      <td>SC</td>
      <td>375402</td>
    </tr>
    <tr>
      <th>32</th>
      <td>NY</td>
      <td>345206</td>
    </tr>
    <tr>
      <th>25</th>
      <td>NC</td>
      <td>334204</td>
    </tr>
    <tr>
      <th>36</th>
      <td>PA</td>
      <td>290596</td>
    </tr>
    <tr>
      <th>43</th>
      <td>VA</td>
      <td>285338</td>
    </tr>
    <tr>
      <th>21</th>
      <td>MN</td>
      <td>189007</td>
    </tr>
    <tr>
      <th>35</th>
      <td>OR</td>
      <td>176442</td>
    </tr>
    <tr>
      <th>12</th>
      <td>IL</td>
      <td>168029</td>
    </tr>
    <tr>
      <th>40</th>
      <td>TN</td>
      <td>166814</td>
    </tr>
    <tr>
      <th>9</th>
      <td>GA</td>
      <td>166529</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AZ</td>
      <td>164548</td>
    </tr>
    <tr>
      <th>20</th>
      <td>MI</td>
      <td>161765</td>
    </tr>
    <tr>
      <th>16</th>
      <td>LA</td>
      <td>148418</td>
    </tr>
    <tr>
      <th>29</th>
      <td>NJ</td>
      <td>137116</td>
    </tr>
    <tr>
      <th>33</th>
      <td>OH</td>
      <td>117354</td>
    </tr>
    <tr>
      <th>18</th>
      <td>MD</td>
      <td>113522</td>
    </tr>
    <tr>
      <th>45</th>
      <td>WA</td>
      <td>107499</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>99730</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CO</td>
      <td>89467</td>
    </tr>
    <tr>
      <th>42</th>
      <td>UT</td>
      <td>88631</td>
    </tr>
    <tr>
      <th>34</th>
      <td>OK</td>
      <td>82869</td>
    </tr>
    <tr>
      <th>22</th>
      <td>MO</td>
      <td>76204</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CT</td>
      <td>70772</td>
    </tr>
    <tr>
      <th>13</th>
      <td>IN</td>
      <td>66357</td>
    </tr>
    <tr>
      <th>17</th>
      <td>MA</td>
      <td>59298</td>
    </tr>
    <tr>
      <th>46</th>
      <td>WI</td>
      <td>34436</td>
    </tr>
    <tr>
      <th>15</th>
      <td>KY</td>
      <td>32002</td>
    </tr>
    <tr>
      <th>27</th>
      <td>NE</td>
      <td>28745</td>
    </tr>
    <tr>
      <th>24</th>
      <td>MT</td>
      <td>27540</td>
    </tr>
    <tr>
      <th>10</th>
      <td>IA</td>
      <td>25686</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AR</td>
      <td>22332</td>
    </tr>
    <tr>
      <th>31</th>
      <td>NV</td>
      <td>21258</td>
    </tr>
    <tr>
      <th>14</th>
      <td>KS</td>
      <td>18319</td>
    </tr>
    <tr>
      <th>6</th>
      <td>DC</td>
      <td>17631</td>
    </tr>
    <tr>
      <th>37</th>
      <td>RI</td>
      <td>16467</td>
    </tr>
    <tr>
      <th>23</th>
      <td>MS</td>
      <td>14968</td>
    </tr>
    <tr>
      <th>7</th>
      <td>DE</td>
      <td>14014</td>
    </tr>
    <tr>
      <th>47</th>
      <td>WV</td>
      <td>13645</td>
    </tr>
    <tr>
      <th>11</th>
      <td>ID</td>
      <td>10350</td>
    </tr>
    <tr>
      <th>30</th>
      <td>NM</td>
      <td>10164</td>
    </tr>
    <tr>
      <th>28</th>
      <td>NH</td>
      <td>10096</td>
    </tr>
    <tr>
      <th>48</th>
      <td>WY</td>
      <td>3369</td>
    </tr>
    <tr>
      <th>26</th>
      <td>ND</td>
      <td>3191</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ME</td>
      <td>2648</td>
    </tr>
    <tr>
      <th>44</th>
      <td>VT</td>
      <td>894</td>
    </tr>
    <tr>
      <th>39</th>
      <td>SD</td>
      <td>280</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1002f592-005c-405a-b2ae-b714adb62627')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1002f592-005c-405a-b2ae-b714adb62627 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1002f592-005c-405a-b2ae-b714adb62627');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-f7fa4f37-3121-42c0-a5ce-633cdfc22c41">
      <button class="colab-df-quickchart" onclick="quickchart('df-f7fa4f37-3121-42c0-a5ce-633cdfc22c41')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-f7fa4f37-3121-42c0-a5ce-633cdfc22c41 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_913da38e-7b54-49e2-9683-40f2fcc396be">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF1')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_913da38e-7b54-49e2-9683-40f2fcc396be button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF1');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="70"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="FckjffoB7kUY" data-outputId="9683312d-c34d-4270-b4dd-45d12c73e2d8">
<div class="sourceCode" id="cb95"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#County of each state with most crashes</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>KF2<span class="op">=</span>(KF2.groupby([<span class="st">&#39;State&#39;</span>,<span class="st">&#39;County&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;State&#39;</span>).head(<span class="dv">1</span>))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>KF2</span></code></pre></div>
<div class="output execute_result" data-execution_count="70">

  <div id="df-90f8bf42-e95f-40ff-9fdb-4d2465f39cbb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>County</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>CA</td>
      <td>Los Angeles</td>
      <td>510723</td>
    </tr>
    <tr>
      <th>13</th>
      <td>FL</td>
      <td>Miami-Dade</td>
      <td>241573</td>
    </tr>
    <tr>
      <th>98</th>
      <td>TX</td>
      <td>Harris</td>
      <td>124999</td>
    </tr>
    <tr>
      <th>54</th>
      <td>NC</td>
      <td>Mecklenburg</td>
      <td>111451</td>
    </tr>
    <tr>
      <th>5</th>
      <td>AZ</td>
      <td>Maricopa</td>
      <td>103414</td>
    </tr>
    <tr>
      <th>96</th>
      <td>TN</td>
      <td>Davidson</td>
      <td>95219</td>
    </tr>
    <tr>
      <th>29</th>
      <td>LA</td>
      <td>East Baton Rouge</td>
      <td>74232</td>
    </tr>
    <tr>
      <th>82</th>
      <td>PA</td>
      <td>Montgomery</td>
      <td>66174</td>
    </tr>
    <tr>
      <th>20</th>
      <td>IL</td>
      <td>Cook</td>
      <td>60289</td>
    </tr>
    <tr>
      <th>43</th>
      <td>MN</td>
      <td>Hennepin</td>
      <td>58888</td>
    </tr>
    <tr>
      <th>85</th>
      <td>SC</td>
      <td>Greenville</td>
      <td>56792</td>
    </tr>
    <tr>
      <th>106</th>
      <td>WA</td>
      <td>King</td>
      <td>56753</td>
    </tr>
    <tr>
      <th>15</th>
      <td>GA</td>
      <td>Fulton</td>
      <td>54394</td>
    </tr>
    <tr>
      <th>77</th>
      <td>OK</td>
      <td>Oklahoma</td>
      <td>45272</td>
    </tr>
    <tr>
      <th>99</th>
      <td>UT</td>
      <td>Salt Lake</td>
      <td>37783</td>
    </tr>
    <tr>
      <th>80</th>
      <td>OR</td>
      <td>Multnomah</td>
      <td>32896</td>
    </tr>
    <tr>
      <th>24</th>
      <td>IN</td>
      <td>Marion</td>
      <td>32135</td>
    </tr>
    <tr>
      <th>40</th>
      <td>MI</td>
      <td>Genesee</td>
      <td>29588</td>
    </tr>
    <tr>
      <th>100</th>
      <td>VA</td>
      <td>Fairfax County</td>
      <td>25808</td>
    </tr>
    <tr>
      <th>72</th>
      <td>NY</td>
      <td>Queens</td>
      <td>22194</td>
    </tr>
    <tr>
      <th>61</th>
      <td>NE</td>
      <td>Douglas</td>
      <td>21134</td>
    </tr>
    <tr>
      <th>35</th>
      <td>MD</td>
      <td>Prince George's</td>
      <td>19477</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>Jefferson</td>
      <td>19081</td>
    </tr>
    <tr>
      <th>8</th>
      <td>CO</td>
      <td>Denver</td>
      <td>18627</td>
    </tr>
    <tr>
      <th>76</th>
      <td>OH</td>
      <td>Montgomery</td>
      <td>17887</td>
    </tr>
    <tr>
      <th>11</th>
      <td>DC</td>
      <td>District of Columbia</td>
      <td>17365</td>
    </tr>
    <tr>
      <th>27</th>
      <td>KY</td>
      <td>Jefferson</td>
      <td>16566</td>
    </tr>
    <tr>
      <th>31</th>
      <td>MA</td>
      <td>Middlesex</td>
      <td>16513</td>
    </tr>
    <tr>
      <th>44</th>
      <td>MO</td>
      <td>Jackson</td>
      <td>15560</td>
    </tr>
    <tr>
      <th>108</th>
      <td>WI</td>
      <td>Milwaukee</td>
      <td>13878</td>
    </tr>
    <tr>
      <th>83</th>
      <td>RI</td>
      <td>Providence</td>
      <td>13064</td>
    </tr>
    <tr>
      <th>65</th>
      <td>NJ</td>
      <td>Bergen</td>
      <td>12586</td>
    </tr>
    <tr>
      <th>12</th>
      <td>DE</td>
      <td>New Castle</td>
      <td>12014</td>
    </tr>
    <tr>
      <th>25</th>
      <td>KS</td>
      <td>Johnson</td>
      <td>10567</td>
    </tr>
    <tr>
      <th>70</th>
      <td>NV</td>
      <td>Washoe</td>
      <td>10385</td>
    </tr>
    <tr>
      <th>9</th>
      <td>CT</td>
      <td>Fairfield</td>
      <td>10265</td>
    </tr>
    <tr>
      <th>16</th>
      <td>IA</td>
      <td>Polk</td>
      <td>8474</td>
    </tr>
    <tr>
      <th>68</th>
      <td>NM</td>
      <td>Bernalillo</td>
      <td>7202</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AR</td>
      <td>Pulaski</td>
      <td>6397</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ID</td>
      <td>Ada</td>
      <td>5205</td>
    </tr>
    <tr>
      <th>46</th>
      <td>MS</td>
      <td>Hinds</td>
      <td>4192</td>
    </tr>
    <tr>
      <th>111</th>
      <td>WV</td>
      <td>Kanawha</td>
      <td>3943</td>
    </tr>
    <tr>
      <th>51</th>
      <td>MT</td>
      <td>Gallatin</td>
      <td>3393</td>
    </tr>
    <tr>
      <th>62</th>
      <td>NH</td>
      <td>Hillsborough</td>
      <td>2194</td>
    </tr>
    <tr>
      <th>36</th>
      <td>ME</td>
      <td>Cumberland</td>
      <td>1006</td>
    </tr>
    <tr>
      <th>115</th>
      <td>WY</td>
      <td>Sweetwater</td>
      <td>851</td>
    </tr>
    <tr>
      <th>57</th>
      <td>ND</td>
      <td>Cass</td>
      <td>818</td>
    </tr>
    <tr>
      <th>104</th>
      <td>VT</td>
      <td>Windham</td>
      <td>210</td>
    </tr>
    <tr>
      <th>94</th>
      <td>SD</td>
      <td>Minnehaha</td>
      <td>124</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-90f8bf42-e95f-40ff-9fdb-4d2465f39cbb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-90f8bf42-e95f-40ff-9fdb-4d2465f39cbb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-90f8bf42-e95f-40ff-9fdb-4d2465f39cbb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-d591826a-8981-4f4b-987a-f5eebccffb0a">
      <button class="colab-df-quickchart" onclick="quickchart('df-d591826a-8981-4f4b-987a-f5eebccffb0a')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-d591826a-8981-4f4b-987a-f5eebccffb0a button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_278f4f0a-b9f8-4003-af76-e560450d4433">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF2')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_278f4f0a-b9f8-4003-af76-e560450d4433 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF2');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="71"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="0vuGqA5N7kcQ" data-outputId="9884ccb0-95bf-43e3-d7bd-f9dc6bf7c387">
<div class="sourceCode" id="cb96"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents per Year</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>KF3<span class="op">=</span>(KF3.groupby(<span class="st">&#39;Year&#39;</span>)[<span class="st">&#39;Count&#39;</span>]</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">sum</span>().reset_index())</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>KF3</span></code></pre></div>
<div class="output execute_result" data-execution_count="71">

  <div id="df-f5feb238-a7a6-4d52-8892-dd7099e2b56c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016</td>
      <td>402239</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017</td>
      <td>700517</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2018</td>
      <td>871896</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019</td>
      <td>936059</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020</td>
      <td>1148892</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2021</td>
      <td>1531387</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2022</td>
      <td>1723701</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2023</td>
      <td>240002</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f5feb238-a7a6-4d52-8892-dd7099e2b56c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f5feb238-a7a6-4d52-8892-dd7099e2b56c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f5feb238-a7a6-4d52-8892-dd7099e2b56c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-b2e18193-5e82-48bb-a2b9-6ffdea403c74">
      <button class="colab-df-quickchart" onclick="quickchart('df-b2e18193-5e82-48bb-a2b9-6ffdea403c74')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-b2e18193-5e82-48bb-a2b9-6ffdea403c74 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_fa625325-d491-4861-ac8f-fe91017e97ad">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF3')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_fa625325-d491-4861-ac8f-fe91017e97ad button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF3');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="72"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:426}"
id="KKitmszdANrl" data-outputId="daae4daa-e639-400e-8142-8b07b6259f4b">
<div class="sourceCode" id="cb97"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents by Month</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>KF4<span class="op">=</span>(KF4.groupby(<span class="st">&#39;Month&#39;</span>)[<span class="st">&#39;Count&#39;</span>]</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">sum</span>().reset_index()</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>     .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>KF4</span></code></pre></div>
<div class="output execute_result" data-execution_count="72">

  <div id="df-9bcae50c-a16d-468c-b414-b58f2a9efe44" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>December</td>
      <td>827345</td>
    </tr>
    <tr>
      <th>9</th>
      <td>November</td>
      <td>739924</td>
    </tr>
    <tr>
      <th>4</th>
      <td>January</td>
      <td>733784</td>
    </tr>
    <tr>
      <th>10</th>
      <td>October</td>
      <td>660722</td>
    </tr>
    <tr>
      <th>3</th>
      <td>February</td>
      <td>645712</td>
    </tr>
    <tr>
      <th>11</th>
      <td>September</td>
      <td>635972</td>
    </tr>
    <tr>
      <th>1</th>
      <td>August</td>
      <td>586225</td>
    </tr>
    <tr>
      <th>0</th>
      <td>April</td>
      <td>577550</td>
    </tr>
    <tr>
      <th>6</th>
      <td>June</td>
      <td>556552</td>
    </tr>
    <tr>
      <th>8</th>
      <td>May</td>
      <td>548498</td>
    </tr>
    <tr>
      <th>7</th>
      <td>March</td>
      <td>543672</td>
    </tr>
    <tr>
      <th>5</th>
      <td>July</td>
      <td>498737</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9bcae50c-a16d-468c-b414-b58f2a9efe44')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9bcae50c-a16d-468c-b414-b58f2a9efe44 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9bcae50c-a16d-468c-b414-b58f2a9efe44');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-9cb27508-3411-4d5b-8d0e-6393f6a54938">
      <button class="colab-df-quickchart" onclick="quickchart('df-9cb27508-3411-4d5b-8d0e-6393f6a54938')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-9cb27508-3411-4d5b-8d0e-6393f6a54938 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_672243b8-fe9d-47dd-8364-4ccd5fa23a97">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF4')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_672243b8-fe9d-47dd-8364-4ccd5fa23a97 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF4');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="73"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}"
id="L2WziuMyA9XF" data-outputId="d6406471-f9ba-4e29-8e49-40b1cb6ee034">
<div class="sourceCode" id="cb98"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents by Day of Week</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>KF5<span class="op">=</span>(KF5.groupby(<span class="st">&#39;Day_of_Week&#39;</span>)[<span class="st">&#39;Count&#39;</span>]</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">sum</span>().reset_index()</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>     .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>KF5</span></code></pre></div>
<div class="output execute_result" data-execution_count="73">

  <div id="df-1a830560-34a1-4c40-a794-4ee85e718fd1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Day_of_Week</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Friday</td>
      <td>1335915</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Thursday</td>
      <td>1289321</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Wednesday</td>
      <td>1285505</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Tuesday</td>
      <td>1264145</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Monday</td>
      <td>1184753</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Saturday</td>
      <td>651356</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sunday</td>
      <td>543698</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1a830560-34a1-4c40-a794-4ee85e718fd1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1a830560-34a1-4c40-a794-4ee85e718fd1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1a830560-34a1-4c40-a794-4ee85e718fd1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-36752187-2906-4abb-9b5b-5950b4863507">
      <button class="colab-df-quickchart" onclick="quickchart('df-36752187-2906-4abb-9b5b-5950b4863507')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-36752187-2906-4abb-9b5b-5950b4863507 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_993c2cda-7330-47a9-9859-1102b1ffe872">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF5')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_993c2cda-7330-47a9-9859-1102b1ffe872 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF5');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="74"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:324}"
id="xArATiMuBP7l" data-outputId="7a40731f-48f1-4fa6-eb4a-37204674cd89">
<div class="sourceCode" id="cb99"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents per Temperature Bin</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>KF6<span class="op">=</span>(KF6.groupby(<span class="st">&#39;Temp_Bin&#39;</span>)[<span class="st">&#39;Count&#39;</span>]</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">sum</span>().reset_index()</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>     .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>KF6</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-3374496791.py:2: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  KF6=(KF6.groupby(&#39;Temp_Bin&#39;)[&#39;Count&#39;]
</code></pre>
</div>
<div class="output execute_result" data-execution_count="74">

  <div id="df-07db6a71-2214-4410-8f6d-9641e68e3ddc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temp_Bin</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Cool-Mid Cool</td>
      <td>1858521</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mild-Comfortable</td>
      <td>1693460</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cold</td>
      <td>1422222</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Warm</td>
      <td>1414258</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Very Cold</td>
      <td>612336</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hot</td>
      <td>473166</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Very Hot</td>
      <td>80730</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-07db6a71-2214-4410-8f6d-9641e68e3ddc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-07db6a71-2214-4410-8f6d-9641e68e3ddc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-07db6a71-2214-4410-8f6d-9641e68e3ddc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-bcf0c521-c8bc-4a4d-9d26-0742c1517f6e">
      <button class="colab-df-quickchart" onclick="quickchart('df-bcf0c521-c8bc-4a4d-9d26-0742c1517f6e')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-bcf0c521-c8bc-4a4d-9d26-0742c1517f6e button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_32b41a79-b109-436b-85a3-326297a6339b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF6')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_32b41a79-b109-436b-85a3-326297a6339b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF6');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="75"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:802}"
id="GJw9Mj5cBu-1" data-outputId="5de29c4e-f2e0-4b97-e03e-07f3ea0693d3">
<div class="sourceCode" id="cb101"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Accidents by Year and State (Top3 States)</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>KF7<span class="op">=</span>(KF7.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;State&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">3</span>))</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>KF7</span></code></pre></div>
<div class="output execute_result" data-execution_count="75">

  <div id="df-90d78e0f-df85-45ac-be70-b3c20532cb25" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>State</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>CA</td>
      <td>138224</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016</td>
      <td>TX</td>
      <td>48813</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016</td>
      <td>FL</td>
      <td>36437</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2017</td>
      <td>CA</td>
      <td>150063</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2017</td>
      <td>TX</td>
      <td>82577</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2017</td>
      <td>FL</td>
      <td>36829</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2018</td>
      <td>CA</td>
      <td>153963</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2018</td>
      <td>TX</td>
      <td>77829</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2018</td>
      <td>SC</td>
      <td>43827</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2019</td>
      <td>CA</td>
      <td>208405</td>
    </tr>
    <tr>
      <th>29</th>
      <td>2019</td>
      <td>TX</td>
      <td>71685</td>
    </tr>
    <tr>
      <th>28</th>
      <td>2019</td>
      <td>SC</td>
      <td>56898</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2020</td>
      <td>CA</td>
      <td>277436</td>
    </tr>
    <tr>
      <th>34</th>
      <td>2020</td>
      <td>FL</td>
      <td>103964</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2020</td>
      <td>SC</td>
      <td>43036</td>
    </tr>
    <tr>
      <th>41</th>
      <td>2021</td>
      <td>CA</td>
      <td>333897</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2021</td>
      <td>FL</td>
      <td>238433</td>
    </tr>
    <tr>
      <th>44</th>
      <td>2021</td>
      <td>TX</td>
      <td>100597</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2022</td>
      <td>CA</td>
      <td>367151</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2022</td>
      <td>FL</td>
      <td>260073</td>
    </tr>
    <tr>
      <th>47</th>
      <td>2022</td>
      <td>NY</td>
      <td>46233</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2023</td>
      <td>CA</td>
      <td>72502</td>
    </tr>
    <tr>
      <th>51</th>
      <td>2023</td>
      <td>FL</td>
      <td>22032</td>
    </tr>
    <tr>
      <th>53</th>
      <td>2023</td>
      <td>TX</td>
      <td>9822</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-90d78e0f-df85-45ac-be70-b3c20532cb25')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-90d78e0f-df85-45ac-be70-b3c20532cb25 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-90d78e0f-df85-45ac-be70-b3c20532cb25');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-77d34577-2296-4edb-8c39-07ebbacd2fea">
      <button class="colab-df-quickchart" onclick="quickchart('df-77d34577-2296-4edb-8c39-07ebbacd2fea')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-77d34577-2296-4edb-8c39-07ebbacd2fea button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_7d48262f-7c79-4340-8ed6-f046c7e4d37d">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF7')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_7d48262f-7c79-4340-8ed6-f046c7e4d37d button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF7');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="76"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="Exr46lSQCG4t" data-outputId="16ee18db-d12d-48bc-f385-3e195c28476b">
<div class="sourceCode" id="cb102"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Accidents by Year and Month (Top Month)</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>KF8<span class="op">=</span>(KF8.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Month&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">1</span>)) <span class="co">#Change head number to spot Top n Months per Year</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>KF8</span></code></pre></div>
<div class="output execute_result" data-execution_count="76">

  <div id="df-1288dfcc-43bd-473b-bbe4-fadcbc1bf6d2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>2016</td>
      <td>November</td>
      <td>63525</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2017</td>
      <td>August</td>
      <td>78808</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2018</td>
      <td>November</td>
      <td>80567</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2019</td>
      <td>October</td>
      <td>104719</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2020</td>
      <td>November</td>
      <td>164184</td>
    </tr>
    <tr>
      <th>46</th>
      <td>2021</td>
      <td>December</td>
      <td>176689</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2022</td>
      <td>April</td>
      <td>193400</td>
    </tr>
    <tr>
      <th>60</th>
      <td>2023</td>
      <td>January</td>
      <td>156379</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1288dfcc-43bd-473b-bbe4-fadcbc1bf6d2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1288dfcc-43bd-473b-bbe4-fadcbc1bf6d2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1288dfcc-43bd-473b-bbe4-fadcbc1bf6d2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-b473d1f8-4bc8-40cf-8ee4-6264de7fd871">
      <button class="colab-df-quickchart" onclick="quickchart('df-b473d1f8-4bc8-40cf-8ee4-6264de7fd871')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-b473d1f8-4bc8-40cf-8ee4-6264de7fd871 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_ae1cf1f2-20f3-4bb8-8897-f3a912afa9fa">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF8')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_ae1cf1f2-20f3-4bb8-8897-f3a912afa9fa button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF8');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="77"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:300}"
id="liiGSqnHEO00" data-outputId="e57b95f2-fef6-4301-88ca-bbbc77d6284e">
<div class="sourceCode" id="cb103"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Most Accidents by Year and Day-of-Week</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>KF9<span class="op">=</span>(KF9.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Day_of_Week&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">1</span>))</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>KF9</span></code></pre></div>
<div class="output execute_result" data-execution_count="77">

  <div id="df-4c199a87-fceb-4ea5-9c8e-b5483e394ba1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Day_of_Week</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>2016</td>
      <td>Tuesday</td>
      <td>76088</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2017</td>
      <td>Friday</td>
      <td>131185</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2018</td>
      <td>Tuesday</td>
      <td>161693</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2019</td>
      <td>Tuesday</td>
      <td>168209</td>
    </tr>
    <tr>
      <th>32</th>
      <td>2020</td>
      <td>Thursday</td>
      <td>200048</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2021</td>
      <td>Friday</td>
      <td>275870</td>
    </tr>
    <tr>
      <th>42</th>
      <td>2022</td>
      <td>Friday</td>
      <td>301220</td>
    </tr>
    <tr>
      <th>54</th>
      <td>2023</td>
      <td>Tuesday</td>
      <td>40350</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4c199a87-fceb-4ea5-9c8e-b5483e394ba1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4c199a87-fceb-4ea5-9c8e-b5483e394ba1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4c199a87-fceb-4ea5-9c8e-b5483e394ba1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-6a29594b-e09d-450f-a4f4-4c11e8239a93">
      <button class="colab-df-quickchart" onclick="quickchart('df-6a29594b-e09d-450f-a4f4-4c11e8239a93')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-6a29594b-e09d-450f-a4f4-4c11e8239a93 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_5f8c79d0-3007-4e13-8cb3-e2e269e1f07f">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF9')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_5f8c79d0-3007-4e13-8cb3-e2e269e1f07f button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF9');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="78"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:355}"
id="zUjfKoRqFqdj" data-outputId="4008b655-4e13-4a86-a2ec-fe15cb807df5">
<div class="sourceCode" id="cb104"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#By Year + Temp Bin (Top3 Weather Bins)</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>KF10<span class="op">=</span>(KF10.groupby([<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Temp_Bin&#39;</span>])[<span class="st">&#39;Count&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>      .sort_values(by<span class="op">=</span>[<span class="st">&#39;Year&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>      .groupby(<span class="st">&#39;Year&#39;</span>).head(<span class="dv">1</span>))</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>KF10</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-4064479854.py:2: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  KF10=(KF10.groupby([&#39;Year&#39;,&#39;Temp_Bin&#39;])[&#39;Count&#39;].sum().reset_index()
</code></pre>
</div>
<div class="output execute_result" data-execution_count="78">

  <div id="df-8be943bb-5827-4c52-869a-04b3b62b3c48" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Temp_Bin</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>2016</td>
      <td>Mild-Comfortable</td>
      <td>107216</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2017</td>
      <td>Cool-Mid Cool</td>
      <td>179500</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2018</td>
      <td>Cool-Mid Cool</td>
      <td>210084</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2019</td>
      <td>Cool-Mid Cool</td>
      <td>239857</td>
    </tr>
    <tr>
      <th>30</th>
      <td>2020</td>
      <td>Cool-Mid Cool</td>
      <td>324132</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2021</td>
      <td>Cool-Mid Cool</td>
      <td>357277</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2022</td>
      <td>Mild-Comfortable</td>
      <td>397924</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2023</td>
      <td>Cold</td>
      <td>93365</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8be943bb-5827-4c52-869a-04b3b62b3c48')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8be943bb-5827-4c52-869a-04b3b62b3c48 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8be943bb-5827-4c52-869a-04b3b62b3c48');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-d5db3c83-df6d-4452-bc5e-b44f1ad71c03">
      <button class="colab-df-quickchart" onclick="quickchart('df-d5db3c83-df6d-4452-bc5e-b44f1ad71c03')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-d5db3c83-df6d-4452-bc5e-b44f1ad71c03 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_1a3c3343-4e33-4dd6-b130-3724457ae4a4">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF10')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_1a3c3343-4e33-4dd6-b130-3724457ae4a4 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF10');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="e3fPizD4NsB2">
<p>###<strong>CUDF Time Analysis</strong></p>
</div>
<div class="cell code" data-execution_count="79"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:429}"
id="_2qzwDYSNyug" data-outputId="157861cf-7e51-4001-d267-e8e5c8f79fed">
<div class="sourceCode" id="cb106"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>cf.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="79">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>End_Time</th>
      <th>Distance(mi)</th>
      <th>City</th>
      <th>County</th>
      <th>State</th>
      <th>Zipcode</th>
      <th>...</th>
      <th>Weather_Condition</th>
      <th>Crossing</th>
      <th>Give_Way</th>
      <th>Railway</th>
      <th>Roundabout</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
      <th>Time_Delta</th>
      <th>Hour</th>
      <th>Hour_Bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A-1</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 05:46:00</td>
      <td>2016-02-08 11:00:00</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45424</td>
      <td>...</td>
      <td>Light Rain</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 05:14:00</td>
      <td>5</td>
      <td>Night</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A-2</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:07:59</td>
      <td>2016-02-08 06:37:59</td>
      <td>0.01</td>
      <td>Reynoldsburg</td>
      <td>Franklin</td>
      <td>OH</td>
      <td>43068-3402</td>
      <td>...</td>
      <td>Light Rain</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:30:00</td>
      <td>6</td>
      <td>Morning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A-3</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 06:49:27</td>
      <td>2016-02-08 07:19:27</td>
      <td>0.01</td>
      <td>Williamsburg</td>
      <td>Clermont</td>
      <td>OH</td>
      <td>45176</td>
      <td>...</td>
      <td>Overcast</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:30:00</td>
      <td>6</td>
      <td>Morning</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A-4</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-02-08 07:23:34</td>
      <td>2016-02-08 07:53:34</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45417</td>
      <td>...</td>
      <td>Mostly Cloudy</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:30:00</td>
      <td>7</td>
      <td>Morning</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A-5</td>
      <td>Source2</td>
      <td>2</td>
      <td>2016-02-08 07:39:07</td>
      <td>2016-02-08 08:09:07</td>
      <td>0.01</td>
      <td>Dayton</td>
      <td>Montgomery</td>
      <td>OH</td>
      <td>45459</td>
      <td>...</td>
      <td>Mostly Cloudy</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:30:00</td>
      <td>7</td>
      <td>Morning</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="80"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:802}"
id="H3cSqSodN0YA" data-outputId="0523b548-a8e7-4cbf-c685-3337ae20276b">
<div class="sourceCode" id="cb107"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hour of day with most accidents</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>CF1<span class="op">=</span>(cf.groupby(<span class="st">&#39;Hour&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>CF1</span></code></pre></div>
<div class="output execute_result" data-execution_count="80">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hour</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18</th>
      <td>7</td>
      <td>535513</td>
    </tr>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>530498</td>
    </tr>
    <tr>
      <th>17</th>
      <td>16</td>
      <td>510046</td>
    </tr>
    <tr>
      <th>10</th>
      <td>17</td>
      <td>506508</td>
    </tr>
    <tr>
      <th>13</th>
      <td>15</td>
      <td>453717</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14</td>
      <td>386136</td>
    </tr>
    <tr>
      <th>14</th>
      <td>18</td>
      <td>382511</td>
    </tr>
    <tr>
      <th>7</th>
      <td>6</td>
      <td>366468</td>
    </tr>
    <tr>
      <th>5</th>
      <td>13</td>
      <td>344612</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>326701</td>
    </tr>
    <tr>
      <th>15</th>
      <td>11</td>
      <td>315273</td>
    </tr>
    <tr>
      <th>8</th>
      <td>12</td>
      <td>310075</td>
    </tr>
    <tr>
      <th>20</th>
      <td>10</td>
      <td>306574</td>
    </tr>
    <tr>
      <th>22</th>
      <td>19</td>
      <td>261123</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>204258</td>
    </tr>
    <tr>
      <th>6</th>
      <td>20</td>
      <td>196884</td>
    </tr>
    <tr>
      <th>23</th>
      <td>21</td>
      <td>165027</td>
    </tr>
    <tr>
      <th>9</th>
      <td>4</td>
      <td>145239</td>
    </tr>
    <tr>
      <th>16</th>
      <td>22</td>
      <td>144461</td>
    </tr>
    <tr>
      <th>12</th>
      <td>23</td>
      <td>107192</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>95459</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>83213</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>79942</td>
    </tr>
    <tr>
      <th>21</th>
      <td>3</td>
      <td>72118</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="81"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}"
id="zdVX0ZVMOJAQ" data-outputId="4f1c0b02-5d88-4e04-d63a-5662db1e26a2">
<div class="sourceCode" id="cb108"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hour Bin with most crashes</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>CF2<span class="op">=</span>(cf.groupby(<span class="st">&#39;Hour_Bin&#39;</span>).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span><span class="st">&#39;Count&#39;</span>,ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>CF2</span></code></pre></div>
<div class="output execute_result" data-execution_count="81">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Hour_Bin</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Afternoon</td>
      <td>2511094</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Morning</td>
      <td>2381027</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Evening</td>
      <td>1257198</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Night</td>
      <td>680229</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="82"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="9cdniYTVO2TY" data-outputId="208f3263-75fb-4b9b-bbcb-926e99d00375">
<div class="sourceCode" id="cb109"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hour with most Accidents per State</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>CF3<span class="op">=</span>(cf.groupby([<span class="st">&#39;State&#39;</span>,<span class="st">&#39;Hour&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;Count&#39;</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    .sort_values(by<span class="op">=</span>[<span class="st">&#39;State&#39;</span>,<span class="st">&#39;Count&#39;</span>],ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>])</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    .groupby(<span class="st">&#39;State&#39;</span>).head(<span class="dv">1</span>))</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>CF3</span></code></pre></div>
<div class="output execute_result" data-execution_count="82">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Hour</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>412</th>
      <td>AL</td>
      <td>17</td>
      <td>9551</td>
    </tr>
    <tr>
      <th>245</th>
      <td>AR</td>
      <td>7</td>
      <td>1478</td>
    </tr>
    <tr>
      <th>255</th>
      <td>AZ</td>
      <td>16</td>
      <td>12716</td>
    </tr>
    <tr>
      <th>810</th>
      <td>CA</td>
      <td>17</td>
      <td>107163</td>
    </tr>
    <tr>
      <th>1117</th>
      <td>CO</td>
      <td>7</td>
      <td>10555</td>
    </tr>
    <tr>
      <th>426</th>
      <td>CT</td>
      <td>16</td>
      <td>4769</td>
    </tr>
    <tr>
      <th>499</th>
      <td>DC</td>
      <td>8</td>
      <td>1364</td>
    </tr>
    <tr>
      <th>986</th>
      <td>DE</td>
      <td>8</td>
      <td>1542</td>
    </tr>
    <tr>
      <th>944</th>
      <td>FL</td>
      <td>8</td>
      <td>61348</td>
    </tr>
    <tr>
      <th>268</th>
      <td>GA</td>
      <td>7</td>
      <td>13721</td>
    </tr>
    <tr>
      <th>1047</th>
      <td>IA</td>
      <td>17</td>
      <td>2347</td>
    </tr>
    <tr>
      <th>89</th>
      <td>ID</td>
      <td>16</td>
      <td>852</td>
    </tr>
    <tr>
      <th>839</th>
      <td>IL</td>
      <td>8</td>
      <td>17308</td>
    </tr>
    <tr>
      <th>626</th>
      <td>IN</td>
      <td>7</td>
      <td>6844</td>
    </tr>
    <tr>
      <th>803</th>
      <td>KS</td>
      <td>7</td>
      <td>1562</td>
    </tr>
    <tr>
      <th>373</th>
      <td>KY</td>
      <td>7</td>
      <td>4299</td>
    </tr>
    <tr>
      <th>199</th>
      <td>LA</td>
      <td>15</td>
      <td>11257</td>
    </tr>
    <tr>
      <th>258</th>
      <td>MA</td>
      <td>7</td>
      <td>7831</td>
    </tr>
    <tr>
      <th>83</th>
      <td>MD</td>
      <td>7</td>
      <td>8241</td>
    </tr>
    <tr>
      <th>230</th>
      <td>ME</td>
      <td>17</td>
      <td>287</td>
    </tr>
    <tr>
      <th>239</th>
      <td>MI</td>
      <td>8</td>
      <td>12589</td>
    </tr>
    <tr>
      <th>327</th>
      <td>MN</td>
      <td>15</td>
      <td>12775</td>
    </tr>
    <tr>
      <th>665</th>
      <td>MO</td>
      <td>7</td>
      <td>6622</td>
    </tr>
    <tr>
      <th>746</th>
      <td>MS</td>
      <td>8</td>
      <td>1316</td>
    </tr>
    <tr>
      <th>1062</th>
      <td>MT</td>
      <td>17</td>
      <td>1280</td>
    </tr>
    <tr>
      <th>586</th>
      <td>NC</td>
      <td>17</td>
      <td>26905</td>
    </tr>
    <tr>
      <th>780</th>
      <td>ND</td>
      <td>17</td>
      <td>185</td>
    </tr>
    <tr>
      <th>26</th>
      <td>NE</td>
      <td>8</td>
      <td>3318</td>
    </tr>
    <tr>
      <th>349</th>
      <td>NH</td>
      <td>17</td>
      <td>939</td>
    </tr>
    <tr>
      <th>487</th>
      <td>NJ</td>
      <td>7</td>
      <td>10118</td>
    </tr>
    <tr>
      <th>294</th>
      <td>NM</td>
      <td>7</td>
      <td>1102</td>
    </tr>
    <tr>
      <th>243</th>
      <td>NV</td>
      <td>7</td>
      <td>1841</td>
    </tr>
    <tr>
      <th>110</th>
      <td>NY</td>
      <td>7</td>
      <td>26739</td>
    </tr>
    <tr>
      <th>1056</th>
      <td>OH</td>
      <td>7</td>
      <td>14176</td>
    </tr>
    <tr>
      <th>634</th>
      <td>OK</td>
      <td>16</td>
      <td>7658</td>
    </tr>
    <tr>
      <th>418</th>
      <td>OR</td>
      <td>17</td>
      <td>10607</td>
    </tr>
    <tr>
      <th>900</th>
      <td>PA</td>
      <td>7</td>
      <td>22765</td>
    </tr>
    <tr>
      <th>4</th>
      <td>RI</td>
      <td>16</td>
      <td>1852</td>
    </tr>
    <tr>
      <th>792</th>
      <td>SC</td>
      <td>17</td>
      <td>30620</td>
    </tr>
    <tr>
      <th>1154</th>
      <td>SD</td>
      <td>16</td>
      <td>26</td>
    </tr>
    <tr>
      <th>303</th>
      <td>TN</td>
      <td>7</td>
      <td>15794</td>
    </tr>
    <tr>
      <th>120</th>
      <td>TX</td>
      <td>8</td>
      <td>48660</td>
    </tr>
    <tr>
      <th>519</th>
      <td>UT</td>
      <td>8</td>
      <td>6976</td>
    </tr>
    <tr>
      <th>424</th>
      <td>VA</td>
      <td>16</td>
      <td>19800</td>
    </tr>
    <tr>
      <th>1080</th>
      <td>VT</td>
      <td>8</td>
      <td>85</td>
    </tr>
    <tr>
      <th>1144</th>
      <td>WA</td>
      <td>17</td>
      <td>7310</td>
    </tr>
    <tr>
      <th>1155</th>
      <td>WI</td>
      <td>8</td>
      <td>3668</td>
    </tr>
    <tr>
      <th>749</th>
      <td>WV</td>
      <td>17</td>
      <td>897</td>
    </tr>
    <tr>
      <th>1002</th>
      <td>WY</td>
      <td>8</td>
      <td>181</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown" id="wEkRZIzZTadh">
<p>##<strong>Step 6: Visualization</strong> At this step we will
visualize most of the preeceding work. We will start with Pandas General
Analysis and continue with CUDF Time-Analysis.</p>
</div>
<div class="cell markdown" id="bcumRXSTM9I0">
<p>###<strong>Pandas</strong></p>
</div>
<div class="cell code" data-execution_count="83"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:814}"
id="EZLzUA69T477" data-outputId="3afa7547-88cf-4503-a9b1-2c0c0809d0e7">
<div class="sourceCode" id="cb110"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#State with Most Accidents (TOP 10)</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>KF1.iloc[:<span class="dv">10</span>,:],x<span class="op">=</span><span class="st">&#39;State&#39;</span>,y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>,hue<span class="op">=</span><span class="st">&#39;State&#39;</span>)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([<span class="st">&#39;0&#39;</span>,<span class="st">&#39;200K&#39;</span>,<span class="st">&#39;400K&#39;</span>,<span class="st">&#39;600K&#39;</span>,<span class="st">&#39;800K&#39;</span>,<span class="st">&#39;1M&#39;</span>,<span class="st">&#39;1.2M&#39;</span>,<span class="st">&#39;1.4M&#39;</span>,<span class="st">&#39;1.6M&#39;</span>],fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(ax.get_xticklabels(),fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Top 10 States with Most Accidents&#39;</span>,fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;State&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Count&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2838209738.py:5: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([&#39;0&#39;,&#39;200K&#39;,&#39;400K&#39;,&#39;600K&#39;,&#39;800K&#39;,&#39;1M&#39;,&#39;1.2M&#39;,&#39;1.4M&#39;,&#39;1.6M&#39;],fontsize=12)
/tmp/ipython-input-2838209738.py:6: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels(ax.get_xticklabels(),fontsize=12)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="83">
<pre><code>Text(0, 0.5, &#39;Count&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_647592d6128f45198d08141d6f656f00/fa422f4196c9be36192160faad468a5804de784d.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="84"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:814}"
id="nNoSIzWx6fBl" data-outputId="79ce9fb9-8b6e-437b-f593-6fab14a6c580">
<div class="sourceCode" id="cb113"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#County with most crashes per State (Top 10 States)</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>sns.color_palette(<span class="st">&#39;deep&#39;</span>)</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>KF2.iloc[:<span class="dv">10</span>,:],x<span class="op">=</span><span class="st">&#39;County&#39;</span>,y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,hue<span class="op">=</span><span class="st">&#39;State&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(ax.get_xticklabels(),fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([<span class="st">&#39;0&#39;</span>,<span class="st">&#39;100K&#39;</span>,<span class="st">&#39;200K&#39;</span>,<span class="st">&#39;300K&#39;</span>,<span class="st">&#39;400K&#39;</span>,<span class="st">&#39;500K&#39;</span>],fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;County with most crashes&#39;</span>,fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;County&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Count&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2389414863.py:6: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels(ax.get_xticklabels(),fontsize=12)
/tmp/ipython-input-2389414863.py:7: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([&#39;0&#39;,&#39;100K&#39;,&#39;200K&#39;,&#39;300K&#39;,&#39;400K&#39;,&#39;500K&#39;],fontsize=12)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="84">
<pre><code>Text(0, 0.5, &#39;Count&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_647592d6128f45198d08141d6f656f00/67c2a256a891840dac67606471b5d46b38921ce0.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="85"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="jQpiU0CX-3OD" data-outputId="48a376a0-d125-45d9-9206-1756a6c6204c">
<div class="sourceCode" id="cb116"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents Per Year, Month, Day of Week</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">13</span>,<span class="dv">13</span>))</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>ax1<span class="op">=</span>fig.add_subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>ax2<span class="op">=</span>fig.add_subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>ax3<span class="op">=</span>fig.add_subplot(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents by Year</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>KF3,ax<span class="op">=</span>ax1,x<span class="op">=</span><span class="st">&#39;Year&#39;</span>,y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>,color<span class="op">=</span><span class="st">&#39;darkorange&#39;</span>)</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">&#39;Year&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">&#39;Count&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Accidents by Year&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>ax1.set_yticklabels([<span class="st">&#39;0&#39;</span>,<span class="st">&#39;250K&#39;</span>,<span class="st">&#39;500K&#39;</span>,<span class="st">&#39;750K&#39;</span>,<span class="st">&#39;1M&#39;</span>,<span class="st">&#39;1.25M&#39;</span>,<span class="st">&#39;1.5M&#39;</span>,<span class="st">&#39;1.75M&#39;</span>],</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>                    fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>ax1.set_xticklabels(ax1.get_xticklabels(),fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents by Month</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>KF4,ax<span class="op">=</span>ax2,x<span class="op">=</span><span class="st">&#39;Month&#39;</span>,y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>,color<span class="op">=</span><span class="st">&#39;slategrey&#39;</span>)</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>ax2.set_xticklabels([tick.get_text()[:<span class="dv">3</span>] <span class="cf">for</span> tick <span class="kw">in</span> ax2.get_xticklabels()],</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>                    fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>ax2.set_yticklabels([<span class="st">&#39;0&#39;</span>,<span class="st">&#39;100K&#39;</span>,<span class="st">&#39;200K&#39;</span>,<span class="st">&#39;300K&#39;</span>,<span class="st">&#39;400K&#39;</span>,<span class="st">&#39;500K&#39;</span>,</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;600K&#39;</span>,<span class="st">&#39;700K&#39;</span>,<span class="st">&#39;800K&#39;</span>],</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>                    fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">&#39;Month&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">&#39;Count&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Accidents by Month&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents by Day of Week</span></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>KF5,ax<span class="op">=</span>ax3,x<span class="op">=</span><span class="st">&#39;Day_of_Week&#39;</span>,y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">&#39;cornflowerblue&#39;</span>)</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="dv">500000</span>,<span class="dv">1400000</span>)</span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>ax3.set_yticks([<span class="dv">500000</span>,<span class="dv">700000</span>,<span class="dv">900000</span>,<span class="dv">1100000</span>,<span class="dv">1300000</span>])</span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>ax3.set_yticklabels([<span class="st">&#39;500K&#39;</span>,<span class="st">&#39;700K&#39;</span>,<span class="st">&#39;900K&#39;</span>,<span class="st">&#39;1.1M&#39;</span>,<span class="st">&#39;1.3M&#39;</span>],fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">&#39;Day of Week&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">&#39;Count&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">&#39;Accidents by Day of Week&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>ax3.set_xticklabels([tick.get_text()[:<span class="dv">3</span>] <span class="cf">for</span> tick <span class="kw">in</span> ax3.get_xticklabels()],</span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a>                    fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a>ax3.set_position([<span class="fl">0.3</span>,<span class="fl">0.04</span>,<span class="fl">0.40</span>,<span class="fl">0.40</span>])</span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2487190097.py:11: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax1.set_yticklabels([&#39;0&#39;,&#39;250K&#39;,&#39;500K&#39;,&#39;750K&#39;,&#39;1M&#39;,&#39;1.25M&#39;,&#39;1.5M&#39;,&#39;1.75M&#39;],
/tmp/ipython-input-2487190097.py:13: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax1.set_xticklabels(ax1.get_xticklabels(),fontsize=11)
/tmp/ipython-input-2487190097.py:16: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax2.set_xticklabels([tick.get_text()[:3] for tick in ax2.get_xticklabels()],
/tmp/ipython-input-2487190097.py:18: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax2.set_yticklabels([&#39;0&#39;,&#39;100K&#39;,&#39;200K&#39;,&#39;300K&#39;,&#39;400K&#39;,&#39;500K&#39;,
/tmp/ipython-input-2487190097.py:33: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax3.set_xticklabels([tick.get_text()[:3] for tick in ax3.get_xticklabels()],
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_647592d6128f45198d08141d6f656f00/0328bd8ebea77a9e440783c136a9018b4254220c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="86"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}"
id="4R8UkaltKmpu" data-outputId="cb4310c6-6153-42be-d913-ddbc1c901983">
<div class="sourceCode" id="cb118"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>KF6</span></code></pre></div>
<div class="output execute_result" data-execution_count="86">

  <div id="df-4aec1a2a-78f8-4d65-800e-9c6a263f86fc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temp_Bin</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Cool-Mid Cool</td>
      <td>1858521</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mild-Comfortable</td>
      <td>1693460</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cold</td>
      <td>1422222</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Warm</td>
      <td>1414258</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Very Cold</td>
      <td>612336</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hot</td>
      <td>473166</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Very Hot</td>
      <td>80730</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4aec1a2a-78f8-4d65-800e-9c6a263f86fc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4aec1a2a-78f8-4d65-800e-9c6a263f86fc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4aec1a2a-78f8-4d65-800e-9c6a263f86fc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-ddf0b341-23cf-4077-a60d-bdf952e38a43">
      <button class="colab-df-quickchart" onclick="quickchart('df-ddf0b341-23cf-4077-a60d-bdf952e38a43')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-ddf0b341-23cf-4077-a60d-bdf952e38a43 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_fec76842-661c-437d-bfa6-06b73865e1a3">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('KF6')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_fec76842-661c-437d-bfa6-06b73865e1a3 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('KF6');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="87"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:813}"
id="Cd4B6c5QQLxf" data-outputId="d64260e4-b9a7-4eb3-e65f-58c6e8551254">
<div class="sourceCode" id="cb119"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Accidents per Temp Bin</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">8</span>))</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>KF6,x<span class="op">=</span><span class="st">&#39;Temp_Bin&#39;</span>,y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(ax.get_xticklabels(),fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([<span class="st">&#39;0&#39;</span>,<span class="st">&#39;250K&#39;</span>,<span class="st">&#39;500K&#39;</span>,<span class="st">&#39;750K&#39;</span>,<span class="st">&#39;1M&#39;</span>,<span class="st">&#39;1.25M&#39;</span>,<span class="st">&#39;1.5M&#39;</span>,<span class="st">&#39;1.75M&#39;</span>],</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>                   fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Temperature Bin&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Count&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Accidents by Temperature Bin&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-3916688274.py:5: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels(ax.get_xticklabels(),fontsize=11)
/tmp/ipython-input-3916688274.py:6: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([&#39;0&#39;,&#39;250K&#39;,&#39;500K&#39;,&#39;750K&#39;,&#39;1M&#39;,&#39;1.25M&#39;,&#39;1.5M&#39;,&#39;1.75M&#39;],
</code></pre>
</div>
<div class="output execute_result" data-execution_count="87">
<pre><code>Text(0.5, 1.0, &#39;Accidents by Temperature Bin&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_647592d6128f45198d08141d6f656f00/7f02d4404169be3778164765d9c7e0775571ad79.png" /></p>
</div>
</div>
<div class="cell markdown" id="XL4WbwpWNCX3">
<p>###<strong>CUDF</strong></p>
</div>
<div class="cell code" data-execution_count="93" id="Er5TrX6GM4ps">
<div class="sourceCode" id="cb122"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dataframes (to avoid class objects)</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>CF1<span class="op">=</span>cudf.DataFrame(CF1)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>CF2<span class="op">=</span>cudf.DataFrame(CF2)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>CF3<span class="op">=</span>cudf.DataFrame(CF3)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="102"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:795}"
id="vRhjhNZiNUJ5" data-outputId="5ceec5d9-2f47-4382-f6f8-1fc491a4b4dc">
<div class="sourceCode" id="cb123"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating Plot</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">13</span>,<span class="dv">8</span>))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Since CUDF is not working well with Seaborn we are sending them back to pandas</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>CF1.to_pandas(),x<span class="op">=</span><span class="st">&#39;Hour&#39;</span>,y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(ax.get_xticklabels(),fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([<span class="st">&#39;0&#39;</span>,<span class="st">&#39;100K&#39;</span>,<span class="st">&#39;200K&#39;</span>,<span class="st">&#39;300K&#39;</span>,<span class="st">&#39;400K&#39;</span>,<span class="st">&#39;500K&#39;</span>],</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>                   fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Hour of Day&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Count&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Accidents by Hour of Day&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>sns.despine()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-2930428461.py:6: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels(ax.get_xticklabels(),fontsize=11)
/tmp/ipython-input-2930428461.py:7: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([&#39;0&#39;,&#39;100K&#39;,&#39;200K&#39;,&#39;300K&#39;,&#39;400K&#39;,&#39;500K&#39;],
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_647592d6128f45198d08141d6f656f00/499fdd72de9bcaeb5682e6a307ac3ab17fe26ff1.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="105"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:525}"
id="OhqX8qI2Nc_Q" data-outputId="b1248ab9-d963-456e-f623-5eceffb5080d">
<div class="sourceCode" id="cb125"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hour Bin with Most Crashes</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>CF2.to_pandas(),x<span class="op">=</span><span class="st">&#39;Hour_Bin&#39;</span>,y<span class="op">=</span><span class="st">&#39;Count&#39;</span>,width<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([<span class="st">&#39;0&#39;</span>,<span class="st">&#39;500K&#39;</span>,<span class="st">&#39;1M&#39;</span>,<span class="st">&#39;1.5M&#39;</span>,<span class="st">&#39;2M&#39;</span>,<span class="st">&#39;2.5M&#39;</span>],</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>                   fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Hour Bin&#39;</span>,fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Count&#39;</span>,fontsize<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Accidents by Hour Bin&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>sns.despine()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-3087890206.py:5: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels([&#39;0&#39;,&#39;500K&#39;,&#39;1M&#39;,&#39;1.5M&#39;,&#39;2M&#39;,&#39;2.5M&#39;],
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_647592d6128f45198d08141d6f656f00/4d8581418b50d6961a36202b5dce221e34f828fc.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="124"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:750}"
id="JUSvULFkR6Uu" data-outputId="3b93adc9-95dc-4602-a9b1-f2e60ca664d5">
<div class="sourceCode" id="cb127"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Hour with Most Accidents per State</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>,<span class="dv">8</span>))</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>sns.barplot(data<span class="op">=</span>CF3.to_pandas(),x<span class="op">=</span><span class="st">&#39;State&#39;</span>,y<span class="op">=</span><span class="st">&#39;Hour&#39;</span>,hue<span class="op">=</span><span class="st">&#39;State&#39;</span>,width<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>,which<span class="op">=</span><span class="st">&#39;major&#39;</span>)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>sns.despine()</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(ax.get_xticklabels(),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(ax.get_yticklabels(),fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;State&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Hour&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Hour with Most Accidents per State&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-1110628980.py:7: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_xticklabels(ax.get_xticklabels(),fontsize=10)
/tmp/ipython-input-1110628980.py:8: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  ax.set_yticklabels(ax.get_yticklabels(),fontsize=10)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="124">
<pre><code>Text(0.5, 1.0, &#39;Hour with Most Accidents per State&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_647592d6128f45198d08141d6f656f00/948b1f6e68ea88267179e1d8bafb5b817a21b638.png" /></p>
</div>
</div>
<div class="cell markdown" id="utT2rA-7V155">
<p>###<strong>Statistical Properties</strong> We will provide a simple
histogram for Accident Duration Distribution in Hours.</p>
</div>
<div class="cell code" data-execution_count="127" id="d29Ds3gJV6FD">
<div class="sourceCode" id="cb130"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Taking a sample of 500K rows</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>cf_sample<span class="op">=</span>cf.sample(n<span class="op">=</span><span class="dv">500000</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="142"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:429}"
id="24iQ5xyNWOTM" data-outputId="360e48b6-e215-43f3-ab97-a60037277115">
<div class="sourceCode" id="cb131"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>cf_sample.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="142">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>Source</th>
      <th>Severity</th>
      <th>Start_Time</th>
      <th>End_Time</th>
      <th>Distance(mi)</th>
      <th>City</th>
      <th>County</th>
      <th>State</th>
      <th>Zipcode</th>
      <th>...</th>
      <th>Crossing</th>
      <th>Give_Way</th>
      <th>Railway</th>
      <th>Roundabout</th>
      <th>Stop</th>
      <th>Traffic_Calming</th>
      <th>Time_Delta</th>
      <th>Hour</th>
      <th>Hour_Bin</th>
      <th>Accident_Duration_Minutes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>47327</th>
      <td>A-47890</td>
      <td>Source2</td>
      <td>3</td>
      <td>2016-07-11 10:54:04</td>
      <td>2016-07-11 11:39:04</td>
      <td>0.000</td>
      <td>National City</td>
      <td>San Diego</td>
      <td>CA</td>
      <td>91950</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:45:00</td>
      <td>10</td>
      <td>Morning</td>
      <td>45.000000</td>
    </tr>
    <tr>
      <th>3442812</th>
      <td>A-3520453</td>
      <td>Source1</td>
      <td>4</td>
      <td>2016-05-26 10:25:17</td>
      <td>2016-05-26 16:25:17</td>
      <td>1.235</td>
      <td>Auburn</td>
      <td>Rockingham</td>
      <td>NH</td>
      <td>03032-3502</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 06:00:00</td>
      <td>10</td>
      <td>Morning</td>
      <td>360.000000</td>
    </tr>
    <tr>
      <th>3507294</th>
      <td>A-3586376</td>
      <td>Source1</td>
      <td>2</td>
      <td>2017-03-07 20:51:10</td>
      <td>2017-03-08 02:51:10</td>
      <td>0.839</td>
      <td>Phoenix</td>
      <td>Maricopa</td>
      <td>AZ</td>
      <td>85015</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 06:00:00</td>
      <td>20</td>
      <td>Evening</td>
      <td>360.000000</td>
    </tr>
    <tr>
      <th>2662598</th>
      <td>A-2720015</td>
      <td>Source2</td>
      <td>2</td>
      <td>2018-07-23 14:06:33</td>
      <td>2018-07-23 14:36:12</td>
      <td>0.000</td>
      <td>Anaheim</td>
      <td>Orange</td>
      <td>CA</td>
      <td>92808</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 00:29:39</td>
      <td>14</td>
      <td>Afternoon</td>
      <td>29.650000</td>
    </tr>
    <tr>
      <th>5757179</th>
      <td>A-6656861</td>
      <td>Source1</td>
      <td>2</td>
      <td>2020-12-22 12:45:30</td>
      <td>2020-12-23 02:25:04</td>
      <td>0.435</td>
      <td>Baton Rouge</td>
      <td>East Baton Rouge</td>
      <td>LA</td>
      <td>70809</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>0 days 13:39:34</td>
      <td>12</td>
      <td>Afternoon</td>
      <td>819.566667</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="146" id="-GSEARL_YIAF">
<div class="sourceCode" id="cb132"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>cf_sample[<span class="st">&#39;Accident_Duration_Hours&#39;</span>]<span class="op">=</span>(cf[<span class="st">&#39;Time_Delta&#39;</span>].dt.seconds<span class="op">/</span><span class="dv">3600</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="160"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:494}"
id="9o4YiiMzW8X7" data-outputId="c2b7e4b9-7464-4e81-8b5e-12f09a184b83">
<div class="sourceCode" id="cb133"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Time_Delta Distribution</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>fig<span class="op">=</span>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>fig.add_subplot(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>cf_sample.to_pandas(),ax<span class="op">=</span>ax,x<span class="op">=</span><span class="st">&#39;Accident_Duration_Hours&#39;</span>,</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>             stat<span class="op">=</span><span class="st">&#39;probability&#39;</span>,bins<span class="op">=</span><span class="dv">100</span>, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="dv">0</span>,<span class="dv">7</span>)</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Accident Duration (Hours)&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Probability&#39;</span>,fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Accident Duration Distribution&#39;</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>sns.despine()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_647592d6128f45198d08141d6f656f00/dd4f8e73241b167d92fa502008b7d3b0107f1cf9.png" /></p>
</div>
</div>
<div class="cell markdown" id="CstH_n9oeJZT">
<p>##<strong>Step 7: Conclusion</strong> Through this exploratory
analysis, we examined the evolution of traffic accidents across the
years 2016–2022 (as the dataset contains partial data for 2023). The
analysis explored both geographical and temporal patterns identifying
key factors such as location, time of day, day of week, and weather
conditions that correlate with accident frequency.</p>
<p><strong>Key Findings</strong></p>
<ul>
<li>Top States and Counties:</li>
</ul>
<p>The states with the highest number of crashes are California (CA),
Florida (FL), and Texas (TX) — with Los Angeles, Miami-Dade, and Harris
counties leading respectively.</p>
<ul>
<li>Yearly Trend:</li>
</ul>
<p>A significant upward trend was observed in total accidents, rising
from approximately 400K in 2016 to 1.75M in 2022.</p>
<ul>
<li>Monthly Distribution:</li>
</ul>
<p>December recorded the highest number of crashes, followed by
November, while July consistently showed the fewest.</p>
<ul>
<li>Day of Week:</li>
</ul>
<p>Fridays have the most crashes, with a steady increase from Monday to
Friday, suggesting higher traffic activity as the week progresses.</p>
<ul>
<li>Temperature Conditions:</li>
</ul>
<p>Contrary to common expectations, most accidents occurred between
10–18°C, followed by 18–24°C, with fewer crashes below 10°C. This
suggests that extreme cold or heat may reduce overall travel activity,
leading to fewer accidents.</p>
<ul>
<li>Time of Day:</li>
</ul>
<p>Peak accident hours were around 7–8 AM and 4–5 PM, aligning with
commuting periods, though overall the afternoon hours (12–18) showed the
highest cumulative crash counts.</p>
<ul>
<li>Accident Duration:</li>
</ul>
<p>Based on a random sample of 500K records (out of 6.8M), the majority
of crashes lasted between 35–45 minutes, indicating a typical response
and clearance window for incidents.</p>
</div>
</body>
</html>
